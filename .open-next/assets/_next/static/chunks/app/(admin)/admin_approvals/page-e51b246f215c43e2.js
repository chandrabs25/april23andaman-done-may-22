(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8551],{2874:function(e,t,a){Promise.resolve().then(a.bind(a,7700))},9763:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var r=a(2265),s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let c=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),n=(e,t)=>{let a=(0,r.forwardRef)((a,n)=>{let{color:o="currentColor",size:l=24,strokeWidth:i=2,absoluteStrokeWidth:d,className:u="",children:p,...m}=a;return(0,r.createElement)("svg",{ref:n,...s,width:l,height:l,stroke:o,strokeWidth:d?24*Number(i)/Number(l):i,className:["lucide","lucide-".concat(c(e)),u].join(" "),...m},[...t.map(e=>{let[t,a]=e;return(0,r.createElement)(t,a)}),...Array.isArray(p)?p:[p]])});return a.displayName="".concat(e),a}},401:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},2208:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},5863:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},2489:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},7648:function(e,t,a){"use strict";a.d(t,{default:function(){return s.a}});var r=a(2972),s=a.n(r)},9376:function(e,t,a){"use strict";var r=a(5475);a.o(r,"useParams")&&a.d(t,{useParams:function(){return r.useParams}}),a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},7700:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return h},dynamic:function(){return u}});var r=a(7437),s=a(2265),c=a(9376),n=a(7648),o=a(5863),l=a(2208),i=a(401),d=a(2489);let u="force-dynamic",p=e=>{let{text:t="Loading..."}=e;return(0,r.jsxs)("div",{className:"flex justify-center items-center py-10",children:[(0,r.jsx)(o.Z,{className:"h-6 w-6 animate-spin text-blue-600 mr-2"}),(0,r.jsx)("span",{children:t})]})};function m(){let e=(0,c.useSearchParams)(),t=(0,c.useRouter)(),a=e.get("type")||"all",[o,u]=(0,s.useState)([]),[m,h]=(0,s.useState)(!1),[x,g]=(0,s.useState)(null),[y,f]=(0,s.useState)({}),[b,v]=(0,s.useState)({totalItems:0,currentPage:1,pageSize:10,totalPages:0}),[j,N]=(0,s.useState)(!1);(0,s.useEffect)(()=>{N(!0)},[]),(0,s.useEffect)(()=>{j&&(async()=>{h(!0),g(null);try{let t=e.get("page")||"1",r=e.get("limit")||"10",s="/api/admin/approvals?page=".concat(t,"&limit=").concat(r);"all"!==a&&(s+="&type=".concat(a));let c=await fetch(s),n=await c.json();if(!c.ok)throw Error(n.message||n.error||"Error: ".concat(c.status));if(n.success)u(n.data.items),v(n.data.pagination);else throw Error(n.message||"Failed to fetch approvals")}catch(e){g(e instanceof Error?e.message:"An unknown error occurred"),console.error("Failed to fetch approvals:",e)}finally{h(!1)}})()},[e,a,j]);let w=a=>{if(a>0&&a<=b.totalPages){let r=new URLSearchParams(e.toString());r.set("page",a.toString()),t.push("/admin_approvals?".concat(r.toString()))}},P=a=>{let r=new URLSearchParams(e.toString());"all"===a?r.delete("type"):r.set("type",a),r.delete("page"),t.push("/admin_approvals?".concat(r.toString()))},k=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),_=async e=>{if(!y["".concat(C(e),"_").concat(e.id)]&&confirm("Are you sure you want to approve this ".concat(Z(e),"?"))){f({...y,["".concat(C(e),"_").concat(e.id)]:!0});try{let t=C(e),a="room"===t?e.id:e.id||0,r=await fetch("/api/admin/approvals/".concat(t,"/").concat(a),{method:"PUT"}),s=await r.json();if(!r.ok)throw Error(s.message||s.error||"Error: ".concat(r.status));if(s.success)u(o.filter(t=>!(t.id===e.id&&Z(t)===Z(e)))),v(e=>({...e,totalItems:e.totalItems-1}));else throw Error(s.message||"Failed to approve item")}catch(e){alert(e instanceof Error?e.message:"Failed to approve item"),console.error("Failed to approve:",e)}finally{let t={...y};delete t["".concat(C(e),"_").concat(e.id)],f(t)}}},S=async e=>{if(y["".concat(C(e),"_").concat(e.id)])return;let t="";if(null!==(t=prompt("Please enter a reason for rejecting this ".concat(Z(e)," (optional):"),"")||"")){f({...y,["".concat(C(e),"_").concat(e.id)]:!0});try{let a=C(e),r="room"===a?e.id:e.id||0,s=await fetch("/api/admin/approvals/".concat(a,"/").concat(r),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({reason:t})}),c=await s.json();if(!s.ok)throw Error(c.message||c.error||"Error: ".concat(s.status));if(c.success)u(o.filter(t=>!(t.id===e.id&&Z(t)===Z(e)))),v(e=>({...e,totalItems:e.totalItems-1}));else throw Error(c.message||"Failed to reject item")}catch(e){alert(e instanceof Error?e.message:"Failed to reject item"),console.error("Failed to reject:",e)}finally{let t={...y};delete t["".concat(C(e),"_").concat(e.id)],f(t)}}},E=e=>"hotel"===e.type||e.hotel_service_id&&!e.type?"/hotels/".concat(e.id):e.type?"/services/".concat(e.type,"/").concat(e.id):"#",Z=e=>e.room_type?"room":"hotel"===e.type?"hotel":e.type?e.type:"item",C=e=>e.room_type?"room":"hotel"===e.type?"hotel":"service",A=e=>e.room_type?"".concat(e.room_type," at ").concat(e.hotel_name||"Unknown Hotel"):e.name||"Unnamed Item",L=e=>e.price_per_night?"₹".concat(e.price_per_night,"/night"):e.price?"₹".concat(e.price):"N/A";return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-semibold mb-6",children:"Pending Approvals"}),(0,r.jsx)("div",{className:"border-b border-gray-200",children:(0,r.jsx)("nav",{className:"flex space-x-4","aria-label":"Tabs",children:[{value:"all",label:"All"},{value:"hotels",label:"Hotels"},{value:"rooms",label:"Room Types"},{value:"services",label:"Services"}].map(e=>(0,r.jsx)("button",{onClick:()=>P(e.value),className:"py-2 px-3 border-b-2 font-medium text-sm ".concat(a===e.value?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),"aria-current":a===e.value?"page":void 0,children:e.label},e.value))})}),x&&(0,r.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:x}),!j||m?(0,r.jsx)(p,{text:"Loading pending approvals..."}):(0,r.jsxs)(r.Fragment,{children:[0===o.length?(0,r.jsx)("div",{className:"bg-white p-6 text-center rounded-lg shadow",children:(0,r.jsx)("p",{className:"text-gray-500",children:"No pending approvals found."})}):(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full bg-white border border-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-100",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"py-3 px-4 text-left",children:"ID"}),(0,r.jsx)("th",{className:"py-3 px-4 text-left",children:"Type"}),(0,r.jsx)("th",{className:"py-3 px-4 text-left",children:"Name"}),(0,r.jsx)("th",{className:"py-3 px-4 text-left",children:"Price"}),(0,r.jsx)("th",{className:"py-3 px-4 text-left",children:"Submitted"}),(0,r.jsx)("th",{className:"py-3 px-4 text-left",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"divide-y divide-gray-200",children:o.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"py-3 px-4",children:e.id}),(0,r.jsx)("td",{className:"py-3 px-4",children:(0,r.jsx)("span",{className:"capitalize",children:Z(e)})}),(0,r.jsx)("td",{className:"py-3 px-4",children:A(e)}),(0,r.jsx)("td",{className:"py-3 px-4",children:L(e)}),(0,r.jsx)("td",{className:"py-3 px-4",children:k(e.created_at)}),(0,r.jsx)("td",{className:"py-3 px-4",children:(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)(n.default,{href:E(e),className:"text-blue-600 hover:text-blue-800",target:"_blank",rel:"noopener noreferrer",children:(0,r.jsx)(l.Z,{className:"h-5 w-5"})}),(0,r.jsx)("button",{onClick:()=>_(e),className:"text-green-600 hover:text-green-800 disabled:opacity-50",disabled:!!y["".concat(C(e),"_").concat(e.id)],children:(0,r.jsx)(i.Z,{className:"h-5 w-5"})}),(0,r.jsx)("button",{onClick:()=>S(e),className:"text-red-600 hover:text-red-800 disabled:opacity-50",disabled:!!y["".concat(C(e),"_").concat(e.id)],children:(0,r.jsx)(d.Z,{className:"h-5 w-5"})})]})})]},"".concat(C(e),"-").concat(e.id)))})]})}),b.totalPages>1&&(0,r.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["Showing ",(b.currentPage-1)*b.pageSize+1," to"," ",Math.min(b.currentPage*b.pageSize,b.totalItems)," of"," ",b.totalItems," items"]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>w(b.currentPage-1),disabled:1===b.currentPage,className:"px-3 py-1 rounded ".concat(1===b.currentPage?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"Previous"}),[...Array(b.totalPages)].map((e,t)=>(0,r.jsx)("button",{onClick:()=>w(t+1),className:"px-3 py-1 rounded ".concat(b.currentPage===t+1?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:t+1},t)),(0,r.jsx)("button",{onClick:()=>w(b.currentPage+1),disabled:b.currentPage===b.totalPages,className:"px-3 py-1 rounded ".concat(b.currentPage===b.totalPages?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"Next"})]})]})]})]})}function h(){return(0,r.jsx)(s.Suspense,{fallback:(0,r.jsx)(p,{text:"Loading Approvals Page..."}),children:(0,r.jsx)(m,{})})}}},function(e){e.O(0,[2972,2971,2117,1744],function(){return e(e.s=2874)}),_N_E=e.O()}]);