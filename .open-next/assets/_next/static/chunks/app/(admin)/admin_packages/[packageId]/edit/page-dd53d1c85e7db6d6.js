(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8201],{9162:function(e,t,a){Promise.resolve().then(a.bind(a,9184))},9763:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var s=a(2265),r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),n=(e,t)=>{let a=(0,s.forwardRef)((a,n)=>{let{color:l="currentColor",size:o=24,strokeWidth:c=2,absoluteStrokeWidth:d,className:m="",children:u,...g}=a;return(0,s.createElement)("svg",{ref:n,...r,width:o,height:o,stroke:l,strokeWidth:d?24*Number(c)/Number(o):c,className:["lucide","lucide-".concat(i(e)),m].join(" "),...g},[...t.map(e=>{let[t,a]=e;return(0,s.createElement)(t,a)}),...Array.isArray(u)?u:[u]])});return a.displayName="".concat(e),a}},2660:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},5863:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9763).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},9554:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9763).Z)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]])},9397:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9763).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},2489:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9763).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},7648:function(e,t,a){"use strict";a.d(t,{default:function(){return r.a}});var s=a(2972),r=a.n(s)},9376:function(e,t,a){"use strict";var s=a(5475);a.o(s,"useParams")&&a.d(t,{useParams:function(){return s.useParams}}),a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}}),a.o(s,"useSearchParams")&&a.d(t,{useSearchParams:function(){return s.useSearchParams}})},9184:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return g}});var s=a(7437),r=a(2265),i=a(9376),n=a(5863),l=a(2660),o=a(9397),c=a(9554),d=a(7648),m=a(1079),u=a(3340);function g(){let e=(0,i.useRouter)(),t=(0,i.useParams)().packageId,[a,g]=(0,r.useState)(!1),[x,p]=(0,r.useState)(!0),[h,y]=(0,r.useState)(null),[f,b]=(0,r.useState)({name:"",description:"",duration:"",base_price:0,max_people:2,itinerary_days:[{dayNumber:1,title:"",description:"",activities:[{name:"",time:"",duration:""}],meals:[""],accommodation:""}],itinerary_highlights:[""],itinerary_inclusions:[""],itinerary_exclusions:[""],itinerary_notes:"",included_services:"",images:[],cancellation_policy:"",is_active:!0,package_categories:[{category_name:"Standard",price:0,hotel_details:"",category_description:"",max_pax_included_in_price:2,images:[]}]});(0,r.useEffect)(()=>{if(!t){y("Package ID is missing."),p(!1);return}(async()=>{p(!0);try{let e=await fetch("/api/admin/packages/".concat(t)),a=await e.json();if(!e.ok||!a.success||!a.data)throw Error(a.message||"Failed to fetch package data.");let{package:s,categories:r}=a.data,i=[{dayNumber:1,title:"",description:"",activities:[{name:"",time:"",duration:""}],meals:[""],accommodation:""}],n=[""],l=[""],o=[""],c="";if(s.itinerary)try{let e=JSON.parse(s.itinerary);if(e&&"object"==typeof e){if(Array.isArray(e.days))i=e.days.map((e,t)=>({dayNumber:e.day||t+1,title:e.title||"",description:"string"==typeof e.description?e.description:"",activities:(Array.isArray(e.activities)&&e.activities.length>0?e.activities:[{name:"",time:"",duration:""}]).map(e=>({name:String(e.name||""),time:String(e.time||""),duration:String(e.duration||"")})),meals:Array.isArray(e.meals)&&e.meals.length>0?e.meals.map(String).filter(e=>""!==e.trim()):[""],accommodation:String(e.accommodation||"")})),0===i.length&&(i=[{dayNumber:1,title:"",description:"",activities:[{name:"",time:"",duration:""}],meals:[""],accommodation:""}]);else{let t=[],a=1;for(;void 0!==e["day".concat(a)];){let s=e["day".concat(a)];"string"==typeof s&&t.push({dayNumber:a,title:"",description:s,activities:[{name:"",time:"",duration:""}],meals:[""],accommodation:""}),a++}t.length>0&&(i=t)}n=Array.isArray(e.highlights)&&e.highlights.length>0?e.highlights.map(String).filter(e=>""!==e.trim()):[""],0===n.length&&(n=[""]),l=Array.isArray(e.inclusions)&&e.inclusions.length>0?e.inclusions.map(String).filter(e=>""!==e.trim()):[""],0===l.length&&(l=[""]),o=Array.isArray(e.exclusions)&&e.exclusions.length>0?e.exclusions.map(String).filter(e=>""!==e.trim()):[""],0===o.length&&(o=[""]),c="string"==typeof e.notes?e.notes:""}}catch(e){console.error("Failed to parse itinerary JSON:",e),y("Failed to parse itinerary data. It may be malformed. Defaulting to empty structure.")}let d=s.images&&j(s.images)||[];b({name:s.name||"",description:s.description||"",duration:s.duration||"",base_price:s.base_price||0,max_people:s.max_people||2,itinerary_days:i,itinerary_highlights:n,itinerary_inclusions:l,itinerary_exclusions:o,itinerary_notes:c,included_services:s.included_services||"",images:d,cancellation_policy:s.cancellation_policy||"",is_active:1===s.is_active,package_categories:r.map(e=>({category_name:e.category_name||"",price:e.price||0,hotel_details:e.hotel_details||"",category_description:e.category_description||"",max_pax_included_in_price:e.max_pax_included_in_price||2,images:e.images&&j(e.images)||[]}))})}catch(e){y(e instanceof Error?e.message:"An unknown error occurred."),console.error("Failed to load package data:",e)}finally{p(!1)}})()},[t]);let j=e=>{try{let t=JSON.parse(e);return Array.isArray(t)?t.map(String):null}catch(t){return console.warn("Failed to parse JSON string:",e,t),null}},v=e=>{let{name:t,value:a,type:s}=e.target;if("checkbox"===s){let a=e.target.checked;b(e=>({...e,[t]:a}));return}if("number"===s){b(e=>({...e,[t]:parseFloat(a)||0}));return}b(e=>({...e,[t]:a}))},_=e=>{if(1===f.itinerary_days.length)return;let t=f.itinerary_days.filter((t,a)=>a!==e);b(e=>({...e,itinerary_days:t}))},N=(e,t,a)=>{let s=[...f.package_categories];"price"===t||"max_pax_included_in_price"===t?s[e][t]="number"==typeof a?a:parseFloat(a)||0:"images"!==t&&(s[e][t]=a),b(e=>({...e,package_categories:s}))},k=e=>{if(1===f.package_categories.length)return;let t=f.package_categories.filter((t,a)=>a!==e);b(e=>({...e,package_categories:t}))},w=(e,t,a)=>{b(s=>{let r=[...s[e]];return r[t]=a,{...s,[e]:r}})},C=e=>{b(t=>({...t,[e]:[...t[e],""]}))},A=(e,t)=>{b(a=>{let s=a[e].filter((e,a)=>a!==t);return 0===s.length&&s.push(""),{...a,[e]:s}})},S=e=>{b(t=>({...t,itinerary_notes:e}))},I=(e,t,a)=>{let s=[...f.itinerary_days];s[e]={...s[e],[t]:a},b(e=>({...e,itinerary_days:s}))},P=(e,t,a,s)=>{let r=[...f.itinerary_days],i=[...r[e].activities];i[t]={...i[t],[a]:s},r[e].activities=i,b(e=>({...e,itinerary_days:r}))},D=e=>{let t=[...f.itinerary_days];t[e].activities.push({name:"",time:"",duration:""}),b(e=>({...e,itinerary_days:t}))},Z=(e,t)=>{let a=[...f.itinerary_days];a[e].activities=a[e].activities.filter((e,a)=>a!==t),0===a[e].activities.length&&a[e].activities.push({name:"",time:"",duration:""}),b(e=>({...e,itinerary_days:a}))},E=(e,t,a)=>{let s=[...f.itinerary_days],r=[...s[e].meals];r[t]=a,s[e].meals=r,b(e=>({...e,itinerary_days:s}))},T=e=>{let t=[...f.itinerary_days];t[e].meals.push(""),b(e=>({...e,itinerary_days:t}))},F=(e,t)=>{let a=[...f.itinerary_days];a[e].meals=a[e].meals.filter((e,a)=>a!==t),0===a[e].meals.length&&a[e].meals.push(""),b(e=>({...e,itinerary_days:a}))},M=(e,t)=>{let a=[...f.package_categories];a[e].images=t,b(e=>({...e,package_categories:a})),(0,u.Am)({title:"Category ".concat(e+1," Images Updated"),description:"New images are staged. Save the package to apply all changes."})},O=async a=>{if(a.preventDefault(),!t){y("Package ID is missing. Cannot update.");return}g(!0),y(null);let s={days:f.itinerary_days.map(e=>({day:e.dayNumber,title:e.title,description:e.description,activities:e.activities.filter(e=>""!==e.name.trim()),meals:e.meals.filter(e=>""!==e.trim()),accommodation:e.accommodation})),highlights:f.itinerary_highlights.filter(e=>""!==e.trim()),inclusions:f.itinerary_inclusions.filter(e=>""!==e.trim()),exclusions:f.itinerary_exclusions.filter(e=>""!==e.trim()),notes:f.itinerary_notes},r={...f,itinerary:s};delete r.itinerary_days,delete r.itinerary_highlights,delete r.itinerary_inclusions,delete r.itinerary_exclusions,delete r.itinerary_notes;try{let a=await fetch("/api/admin/packages/".concat(t),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),s=await a.json();if(!a.ok||!s.success)throw Error(s.message||s.error||"Error: ".concat(a.status));(0,u.Am)({title:"Success",description:"Package updated successfully!"}),s.warning&&(0,u.Am)({variant:"default",title:"Notice",description:s.warning,duration:7e3}),e.push("/admin_packages")}catch(e){y(e instanceof Error?e.message:"An unknown error occurred while updating the package"),console.error("Failed to update package:",e),(0,u.Am)({variant:"destructive",title:"Update Failed",description:e instanceof Error?e.message:"Could not update package."})}finally{g(!1)}};return x?(0,s.jsxs)("div",{className:"min-h-screen flex items-center justify-center",children:[(0,s.jsx)(n.Z,{className:"h-12 w-12 animate-spin text-blue-600"}),(0,s.jsx)("span",{className:"ml-4 text-lg text-gray-700",children:"Loading package details..."})]}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(d.default,{href:"/admin_packages",className:"text-gray-500 hover:text-gray-700",children:(0,s.jsx)(l.Z,{className:"h-5 w-5"})}),(0,s.jsxs)("h1",{className:"text-2xl font-semibold",children:["Edit Package (ID: ",t,")"]})]}),h&&(0,s.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert",children:[(0,s.jsx)("strong",{className:"font-bold",children:"Error: "}),(0,s.jsx)("span",{className:"block sm:inline",children:h})]}),(0,s.jsxs)("form",{onSubmit:O,className:"space-y-8",children:[(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,s.jsx)("h2",{className:"text-xl font-medium mb-4",children:"Basic Details"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Package Name *"}),(0,s.jsx)("input",{type:"text",id:"name",name:"name",required:!0,value:f.name,onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"duration",className:"block text-sm font-medium text-gray-700 mb-1",children:"Duration *"}),(0,s.jsx)("input",{type:"text",id:"duration",name:"duration",required:!0,placeholder:"e.g., 3 Days / 2 Nights",value:f.duration,onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"base_price",className:"block text-sm font-medium text-gray-700 mb-1",children:"Base Price *"}),(0,s.jsx)("input",{type:"number",id:"base_price",name:"base_price",required:!0,min:"0",step:"0.01",value:f.base_price,onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"max_people",className:"block text-sm font-medium text-gray-700 mb-1",children:"Max People"}),(0,s.jsx)("input",{type:"number",id:"max_people",name:"max_people",min:"1",value:f.max_people,onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,s.jsx)("textarea",{id:"description",name:"description",rows:3,value:f.description,onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,s.jsxs)("div",{className:"md:col-span-2 space-y-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Itinerary Days"}),(0,s.jsxs)("button",{type:"button",onClick:()=>{b(e=>({...e,itinerary_days:[...e.itinerary_days,{dayNumber:e.itinerary_days.length+1,title:"",description:"",activities:[{name:"",time:"",duration:""}],meals:[""],accommodation:""}]}))},className:"inline-flex items-center px-3 py-1 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[(0,s.jsx)(o.Z,{className:"h-4 w-4 mr-1"})," Add Day"]})]}),f.itinerary_days.map((e,t)=>(0,s.jsxs)("div",{className:"space-y-2 border border-gray-200 p-4 rounded-md",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("h4",{className:"text-md font-semibold text-gray-700",children:["Day ",e.dayNumber]}),f.itinerary_days.length>1&&(0,s.jsxs)("button",{type:"button",onClick:()=>_(t),className:"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:[(0,s.jsx)(c.Z,{className:"h-3 w-3 mr-1"})," Remove Day"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"itinerary_day_title_".concat(t),className:"block text-xs font-medium text-gray-600",children:"Title"}),(0,s.jsx)("input",{type:"text",id:"itinerary_day_title_".concat(t),value:e.title,onChange:e=>I(t,"title",e.target.value),className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"Title for Day ".concat(e.dayNumber)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"itinerary_day_description_".concat(t),className:"block text-xs font-medium text-gray-600",children:"Description"}),(0,s.jsx)("textarea",{id:"itinerary_day_description_".concat(t),rows:2,value:e.description,onChange:e=>I(t,"description",e.target.value),className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"Details for Day ".concat(e.dayNumber,"...")})]}),(0,s.jsxs)("div",{className:"space-y-2 pt-2",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("h5",{className:"text-sm font-medium text-gray-600",children:"Activities"}),(0,s.jsxs)("button",{type:"button",onClick:()=>D(t),className:"text-xs px-2 py-1 bg-green-500 text-white rounded hover:bg-green-600",children:[(0,s.jsx)(o.Z,{size:12,className:"inline mr-1"}),"Add Activity"]})]}),e.activities.map((a,r)=>(0,s.jsxs)("div",{className:"grid grid-cols-12 gap-2 items-end text-xs",children:[(0,s.jsxs)("div",{className:"col-span-5",children:[(0,s.jsx)("label",{className:"block text-xs font-extralight text-gray-500",children:"Name"}),(0,s.jsx)("input",{type:"text",placeholder:"Activity Name",value:a.name,onChange:e=>P(t,r,"name",e.target.value),className:"w-full px-2 py-1 border border-gray-200 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-400"})]}),(0,s.jsxs)("div",{className:"col-span-3",children:[(0,s.jsx)("label",{className:"block text-xs font-extralight text-gray-500",children:"Time"}),(0,s.jsx)("input",{type:"text",placeholder:"e.g. 09:00 AM",value:a.time,onChange:e=>P(t,r,"time",e.target.value),className:"w-full px-2 py-1 border border-gray-200 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-400"})]}),(0,s.jsxs)("div",{className:"col-span-3",children:[(0,s.jsx)("label",{className:"block text-xs font-extralight text-gray-500",children:"Duration"}),(0,s.jsx)("input",{type:"text",placeholder:"e.g. 2 hours",value:a.duration,onChange:e=>P(t,r,"duration",e.target.value),className:"w-full px-2 py-1 border border-gray-200 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-400"})]}),(0,s.jsx)("div",{className:"col-span-1",children:e.activities.length>1&&(0,s.jsx)("button",{type:"button",onClick:()=>Z(t,r),className:"p-1 bg-red-500 text-white rounded hover:bg-red-600",children:(0,s.jsx)(c.Z,{size:12})})})]},r))]}),(0,s.jsxs)("div",{className:"space-y-2 pt-2",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("h5",{className:"text-sm font-medium text-gray-600",children:"Meals"}),(0,s.jsxs)("button",{type:"button",onClick:()=>T(t),className:"text-xs px-2 py-1 bg-green-500 text-white rounded hover:bg-green-600",children:[(0,s.jsx)(o.Z,{size:12,className:"inline mr-1"}),"Add Meal"]})]}),e.meals.map((a,r)=>(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,s.jsx)("input",{type:"text",placeholder:"e.g. Breakfast, Lunch",value:a,onChange:e=>E(t,r,e.target.value),className:"flex-grow px-2 py-1 border border-gray-200 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-400"}),e.meals.length>1&&(0,s.jsx)("button",{type:"button",onClick:()=>F(t,r),className:"p-1 bg-red-500 text-white rounded hover:bg-red-600",children:(0,s.jsx)(c.Z,{size:12})})]},r))]}),(0,s.jsxs)("div",{className:"pt-2",children:[(0,s.jsx)("label",{htmlFor:"itinerary_day_accommodation_".concat(t),className:"block text-sm font-medium text-gray-600",children:"Accommodation"}),(0,s.jsx)("input",{type:"text",id:"itinerary_day_accommodation_".concat(t),value:e.accommodation,onChange:e=>I(t,"accommodation",e.target.value),className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"e.g., Hotel Name - Room Type"})]})]},t)),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:'Click "Add Day" for multi-day packages.'})]}),(0,s.jsxs)("div",{className:"md:col-span-2 space-y-4 p-4 border border-gray-200 rounded-md",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-700",children:"Overall Itinerary Details"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-600",children:"Highlights"}),(0,s.jsxs)("button",{type:"button",onClick:()=>C("itinerary_highlights"),className:"text-xs px-2 py-1 bg-green-500 text-white rounded hover:bg-green-600",children:[(0,s.jsx)(o.Z,{size:12,className:"inline mr-1"}),"Add Highlight"]})]}),f.itinerary_highlights.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,s.jsx)("input",{type:"text",placeholder:"e.g., Visit to Cellular Jail",value:e,onChange:e=>w("itinerary_highlights",t,e.target.value),className:"flex-grow px-2 py-1 border border-gray-200 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-400"}),f.itinerary_highlights.length>1&&(0,s.jsx)("button",{type:"button",onClick:()=>A("itinerary_highlights",t),className:"p-1 bg-red-500 text-white rounded hover:bg-red-600",children:(0,s.jsx)(c.Z,{size:12})})]},t))]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-600",children:"Inclusions"}),(0,s.jsxs)("button",{type:"button",onClick:()=>C("itinerary_inclusions"),className:"text-xs px-2 py-1 bg-green-500 text-white rounded hover:bg-green-600",children:[(0,s.jsx)(o.Z,{size:12,className:"inline mr-1"}),"Add Inclusion"]})]}),f.itinerary_inclusions.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,s.jsx)("input",{type:"text",placeholder:"e.g., All Permits and Entry Tickets",value:e,onChange:e=>w("itinerary_inclusions",t,e.target.value),className:"flex-grow px-2 py-1 border border-gray-200 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-400"}),f.itinerary_inclusions.length>1&&(0,s.jsx)("button",{type:"button",onClick:()=>A("itinerary_inclusions",t),className:"p-1 bg-red-500 text-white rounded hover:bg-red-600",children:(0,s.jsx)(c.Z,{size:12})})]},t))]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-600",children:"Exclusions"}),(0,s.jsxs)("button",{type:"button",onClick:()=>C("itinerary_exclusions"),className:"text-xs px-2 py-1 bg-green-500 text-white rounded hover:bg-green-600",children:[(0,s.jsx)(o.Z,{size:12,className:"inline mr-1"}),"Add Exclusion"]})]}),f.itinerary_exclusions.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,s.jsx)("input",{type:"text",placeholder:"e.g., Personal Expenses",value:e,onChange:e=>w("itinerary_exclusions",t,e.target.value),className:"flex-grow px-2 py-1 border border-gray-200 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-400"}),f.itinerary_exclusions.length>1&&(0,s.jsx)("button",{type:"button",onClick:()=>A("itinerary_exclusions",t),className:"p-1 bg-red-500 text-white rounded hover:bg-red-600",children:(0,s.jsx)(c.Z,{size:12})})]},t))]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"itinerary_notes",className:"block text-sm font-medium text-gray-600",children:"Itinerary Notes"}),(0,s.jsx)("textarea",{id:"itinerary_notes",rows:3,value:f.itinerary_notes,onChange:e=>S(e.target.value),className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"Any special notes for the itinerary..."})]})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("label",{htmlFor:"included_services",className:"block text-sm font-medium text-gray-700 mb-1",children:"Included Services"}),(0,s.jsx)("textarea",{id:"included_services",name:"included_services",rows:3,value:f.included_services,onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Airport transfers, Sightseeing, Meals, etc."})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("label",{htmlFor:"cancellation_policy",className:"block text-sm font-medium text-gray-700 mb-1",children:"Cancellation Policy"}),(0,s.jsx)("textarea",{id:"cancellation_policy",name:"cancellation_policy",rows:3,value:f.cancellation_policy,onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Cancellation terms and conditions..."})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-700 mb-2",children:"Package Images"}),(0,s.jsx)(m.w,{label:"Update Images for the Package",onImagesUploaded:e=>{b(t=>({...t,images:e})),(0,u.Am)({title:"Main Images Updated",description:"New main package images are staged. Save the package to apply all changes."})},existingImages:f.images,parentId:t,type:"package",maxImages:10,helperText:"Upload new or replace existing images for the package."})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",id:"is_active",name:"is_active",checked:f.is_active,onChange:e=>b(t=>({...t,is_active:e.target.checked})),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,s.jsx)("label",{htmlFor:"is_active",className:"ml-2 block text-sm text-gray-900",children:"Active (visible to users)"})]})]})]}),(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)("h2",{className:"text-xl font-medium",children:"Package Categories"}),(0,s.jsxs)("button",{type:"button",onClick:()=>{b(e=>({...e,package_categories:[...e.package_categories,{category_name:"",price:0,hotel_details:"",category_description:"",max_pax_included_in_price:2,images:[]}]}))},className:"inline-flex items-center px-3 py-1 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,s.jsx)(o.Z,{className:"h-4 w-4 mr-1"})," Add Category"]})]}),f.package_categories.map((e,a)=>(0,s.jsxs)("div",{className:"mb-8 border-b pb-6 last:border-b-0 last:pb-0",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsxs)("h3",{className:"text-lg font-medium",children:["Category ",a+1,": ",e.category_name||"New Category"]}),(0,s.jsxs)("button",{type:"button",onClick:()=>k(a),disabled:1===f.package_categories.length,className:"inline-flex items-center px-2 py-1 border border-transparent text-sm font-medium rounded-md ".concat(1===f.package_categories.length?"text-gray-400 bg-gray-100 cursor-not-allowed":"text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"),children:[(0,s.jsx)(c.Z,{className:"h-4 w-4 mr-1"})," Remove"]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category Name *"}),(0,s.jsx)("input",{type:"text",required:!0,value:e.category_name,onChange:e=>N(a,"category_name",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Standard, Deluxe, Premium"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price *"}),(0,s.jsx)("input",{type:"number",required:!0,min:"0",step:"0.01",value:e.price,onChange:e=>N(a,"price",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max People Included in Price"}),(0,s.jsx)("input",{type:"number",min:"1",value:e.max_pax_included_in_price,onChange:e=>N(a,"max_pax_included_in_price",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hotel Details"}),(0,s.jsx)("textarea",{rows:3,value:e.hotel_details,onChange:e=>N(a,"hotel_details",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Port Blair: Hotel Royal Palace - Deluxe AC Room, Havelock: Symphony Palms - Premium Cottage"})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category Description"}),(0,s.jsx)("textarea",{rows:2,value:e.category_description,onChange:e=>N(a,"category_description",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Additional information about this category"})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category Images"}),(0,s.jsx)(m.w,{label:"Images for Category ".concat(a+1),onImagesUploaded:e=>M(a,e),existingImages:e.images,parentId:"".concat(t,"-category-").concat(a),type:"package_category",maxImages:5,helperText:"Update images specific to this category."})]})]})]},a))]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,s.jsx)(d.default,{href:"/admin_packages",className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:a||x,className:"px-6 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ".concat(a||x?"opacity-75 cursor-not-allowed":""),children:a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.Z,{size:16,className:"animate-spin mr-2"})," Saving Changes..."]}):"Save Changes"})]})]})]})}},1079:function(e,t,a){"use strict";a.d(t,{w:function(){return c}});var s=a(7437),r=a(2265);let i=(0,a(9763).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);var n=a(2489),l=a(5863),o=a(9397);function c(e){let{label:t,onImagesUploaded:a,existingImages:c=[],parentId:d,type:m,maxImages:u=10,helperText:g}=e,[x,p]=(0,r.useState)(c),[h,y]=(0,r.useState)(!1),[f,b]=(0,r.useState)(null),[j,v]=(0,r.useState)(!1),_=(0,r.useRef)(null),N=async e=>{let t=e.target.files;if(!t||0===t.length)return;if(x.length+t.length>u){b("You can only upload a maximum of ".concat(u," images"));return}y(!0),b(null);let s=new FormData;s.append("parentId",d.toString()),s.append("type",m),Array.from(t).forEach(e=>{s.append("images",e)});try{var r;let e=await fetch("/api/upload/images",{method:"POST",body:s});if(!e.ok){let t=await e.json();throw Error(t.message||t.error||"Failed to upload images")}let t=await e.json();(null===(r=t.message)||void 0===r?void 0:r.includes("Cloudflare environment"))&&v(!0);let i=t.imageUrls,n=[...x,...i];p(n),a(n)}catch(e){console.error("Upload error:",e),b(e instanceof Error?e.message:"Failed to upload images")}finally{y(!1),_.current&&(_.current.value="")}},k=e=>{let t=x.filter((t,a)=>a!==e);p(t),a(t)};return(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:t}),(0,s.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 mb-3",children:[x.map((e,t)=>(0,s.jsxs)("div",{className:"relative group aspect-square border border-gray-200 rounded-md overflow-hidden shadow-sm",children:[j?(0,s.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 text-gray-500",children:(0,s.jsxs)("div",{className:"text-center p-2",children:[(0,s.jsx)(i,{size:24,className:"mx-auto mb-1"}),(0,s.jsxs)("span",{className:"text-xs",children:["Image ",t+1]})]})}):(0,s.jsx)("img",{src:e,alt:"Uploaded image ".concat(t+1),className:"w-full h-full object-cover"}),(0,s.jsx)("button",{type:"button",onClick:()=>k(t),className:"absolute top-1 right-1 bg-red-500 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity","aria-label":"Remove image",children:(0,s.jsx)(n.Z,{size:14})})]},t)),x.length<u&&(0,s.jsx)("button",{type:"button",onClick:()=>{_.current&&_.current.click()},disabled:h,className:"flex flex-col items-center justify-center border-2 border-dashed border-gray-300 rounded-md aspect-square hover:border-gray-400 transition-colors",children:h?(0,s.jsx)(l.Z,{className:"h-6 w-6 animate-spin text-gray-500"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.Z,{size:24,className:"text-gray-400"}),(0,s.jsx)("span",{className:"text-xs text-gray-500 mt-2",children:"Add Image"})]})})]}),(0,s.jsx)("input",{type:"file",ref:_,onChange:N,className:"hidden",accept:"image/*",multiple:x.length<u}),f&&(0,s.jsx)("p",{className:"text-red-500 text-sm mt-1",children:f}),j&&(0,s.jsxs)("p",{className:"text-amber-500 text-sm",children:[(0,s.jsx)("strong",{children:"Note:"})," In development mode, images are not actually stored. They will appear as placeholders."]}),g&&(0,s.jsx)("p",{className:"text-xs text-gray-500",children:g}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:[x.length," of ",u," images uploaded"]})]})}},3340:function(e,t,a){"use strict";a.d(t,{Am:function(){return d}}),a(2265);let s=0,r=new Map,i=e=>{if(r.has(e))return;let t=setTimeout(()=>{r.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);r.set(e,t)},n=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?i(a):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],o={toasts:[]};function c(e){o=n(o,e),l.forEach(e=>{e(o)})}function d(e){let{...t}=e,a=(s=(s+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>c({type:"DISMISS_TOAST",toastId:a});return c({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||r()}}}),{id:a,dismiss:r,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:a}})}}}},function(e){e.O(0,[2972,2971,2117,1744],function(){return e(e.s=9162)}),_N_E=e.O()}]);