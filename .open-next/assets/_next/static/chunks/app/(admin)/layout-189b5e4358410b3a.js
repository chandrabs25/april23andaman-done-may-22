(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4480],{3688:function(e,t,s){Promise.resolve().then(s.bind(s,10549))},39763:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var a=s(2265),n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),i=(e,t)=>{let s=(0,a.forwardRef)((s,i)=>{let{color:l="currentColor",size:c=24,strokeWidth:o=2,absoluteStrokeWidth:u,className:d="",children:h,...g}=s;return(0,a.createElement)("svg",{ref:i,...n,width:c,height:c,stroke:l,strokeWidth:u?24*Number(o)/Number(c):o,className:["lucide","lucide-".concat(r(e)),d].join(" "),...g},[...t.map(e=>{let[t,s]=e;return(0,a.createElement)(t,s)}),...Array.isArray(h)?h:[h]])});return s.displayName="".concat(e),s}},65302:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(39763).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},99637:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(39763).Z)("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]])},15863:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(39763).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},47692:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(39763).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},44794:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(39763).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},95805:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(39763).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},27648:function(e,t,s){"use strict";s.d(t,{default:function(){return n.a}});var a=s(72972),n=s.n(a)},10549:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return p}});var a=s(57437),n=s(2265),r=s(27648),i=s(99376),l=s(15863),c=s(47692),o=s(99637),u=s(44794),d=s(95805),h=s(65302),g=s(14438),f=s(84603);function m(){let{logout:e}=(0,f.a)(),[t,s]=(0,n.useState)(!1),r=async()=>{s(!0);try{await e()}catch(e){console.error("Sign out error from useAuth:",e),g.Am.error("Sign out failed. Please try again.")}finally{}};return(0,a.jsxs)("button",{onClick:r,disabled:t,className:"flex w-full items-center space-x-2 text-gray-300 hover:text-white hover:bg-gray-700 px-2 py-2 rounded-md transition-colors disabled:opacity-70",children:[t?(0,a.jsx)(l.Z,{className:"h-5 w-5 animate-spin"}):(0,a.jsx)(c.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:t?"Signing Out...":"Sign Out"})]})}function p(e){let{children:t}=e,{user:s,isAuthenticated:c,isLoading:g}=(0,f.a)(),p=(0,i.useRouter)();if(g)return(0,a.jsxs)("div",{className:"flex h-screen items-center justify-center bg-gray-100",children:[(0,a.jsx)(l.Z,{className:"h-12 w-12 animate-spin text-blue-600"}),(0,a.jsx)("p",{className:"ml-3 text-lg",children:"Loading Admin Panel..."})]});if(!c||(null==s?void 0:s.role_id)!==1)return(0,n.useEffect)(()=>{c?p.replace("/not-authorized"):p.replace("/auth/signin")},[c,s,p]),(0,a.jsxs)("div",{className:"flex h-screen items-center justify-center bg-gray-100",children:[(0,a.jsx)(l.Z,{className:"h-12 w-12 animate-spin text-gray-400"}),(0,a.jsx)("p",{className:"ml-3 text-lg text-gray-600",children:"Verifying credentials and redirecting..."})]});let x=[{href:"/admin_dashboard",label:"Dashboard",icon:(0,a.jsx)(o.Z,{className:"h-5 w-5"})},{href:"/admin_packages",label:"Packages",icon:(0,a.jsx)(u.Z,{className:"h-5 w-5"})},{href:"/admin_bookings",label:"All Bookings",icon:(0,a.jsx)(d.Z,{className:"h-5 w-5"})},{href:"/admin_approvals",label:"Approvals",icon:(0,a.jsx)(h.Z,{className:"h-5 w-5"})}];return(0,a.jsxs)("div",{className:"flex h-screen bg-gray-100",children:[(0,a.jsxs)("div",{className:"w-64 bg-gray-800 text-white",children:[(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Admin Panel"})}),(0,a.jsx)("nav",{className:"mt-6",children:(0,a.jsxs)("ul",{children:[x.map(e=>(0,a.jsx)("li",{className:"px-4 py-2",children:(0,a.jsxs)(r.default,{href:e.href,className:"flex items-center space-x-2 text-gray-300 hover:text-white hover:bg-gray-700 px-2 py-2 rounded-md transition-colors",children:[e.icon,(0,a.jsx)("span",{children:e.label})]})},e.href)),(0,a.jsx)("li",{className:"px-4 py-2 mt-8",children:(0,a.jsx)(m,{})})]})})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-auto",children:[(0,a.jsx)("header",{className:"bg-white shadow",children:(0,a.jsx)("div",{className:"px-4 py-6 sm:px-6 lg:px-8",children:(0,a.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"Admin Dashboard"})})}),(0,a.jsx)("main",{className:"p-6",children:t})]})]})}},84603:function(e,t,s){"use strict";s.d(t,{H:function(){return l},a:function(){return c}});var a=s(57437),n=s(2265),r=s(99376);let i=(0,n.createContext)(void 0),l=e=>{let{children:t}=e,[s,l]=(0,n.useState)(null),[c,o]=(0,n.useState)(!0),u=(0,r.useRouter)(),d=(0,n.useCallback)(async()=>{try{console.log("Checking auth state via /api/auth/me...");let e=await fetch("/api/auth/me",{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include"}),t=await e.json();e.ok&&t.success&&t.data?(console.log("Auth check successful, user found:",t.data),l(t.data)):(console.log("Auth check failed or no user session found."),l(null))}catch(e){console.error("Error checking auth state:",e),l(null)}finally{o(!1)}},[]);(0,n.useEffect)(()=>{o(!0),d()},[d]);let h=(0,n.useCallback)(async(e,t)=>{o(!0);try{console.log("Attempting login with:",e);let s=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t}),credentials:"include"}),a=await s.json();if(s.ok&&a.success&&a.data)return console.log("Login successful:",a.data),l(a.data),o(!1),{success:!0,user:a.data};return console.error("Login API failed:",a.message),l(null),o(!1),{success:!1,user:null}}catch(e){return console.error("Login fetch error:",e),l(null),o(!1),{success:!1,user:null}}},[]),g=(0,n.useCallback)(async(e,t,s)=>{o(!0);try{console.log("Attempting registration for:",t);let a=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:t,password:s})}),n=await a.json();if(a.ok&&n.success)return console.log("Registration successful",n.message),o(!1),{success:!0,message:n.message||"Registration successful!"};return console.error("Registration API failed:",n.message),o(!1),{success:!1,message:n.message||"Registration failed."}}catch(e){return console.error("Registration fetch error:",e),o(!1),{success:!1,message:"An unexpected error occurred."}}},[]),f=(0,n.useCallback)(async()=>{try{console.log("Logging out..."),await fetch("/api/auth/logout",{method:"POST",credentials:"include"})}catch(e){console.error("Logout API call failed:",e)}finally{l(null),console.log("Redirecting to signin page after logout."),u.push("/auth/signin")}},[u]);return(0,a.jsx)(i.Provider,{value:{user:s,isAuthenticated:!!s,isLoading:c,login:h,register:g,logout:f,checkAuthState:d},children:t})},c=()=>{let e=(0,n.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},function(e){e.O(0,[2972,4799,2971,2117,1744],function(){return e(e.s=3688)}),_N_E=e.O()}]);