(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[664],{4415:function(e,t,s){Promise.resolve().then(s.bind(s,3508))},9763:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var a=s(2265),n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),i=(e,t)=>{let s=(0,a.forwardRef)((s,i)=>{let{color:l="currentColor",size:c=24,strokeWidth:o=2,absoluteStrokeWidth:u,className:d="",children:m,...x}=s;return(0,a.createElement)("svg",{ref:i,...n,width:c,height:c,stroke:l,strokeWidth:u?24*Number(o)/Number(c):o,className:["lucide","lucide-".concat(r(e)),d].join(" "),...x},[...t.map(e=>{let[t,s]=e;return(0,a.createElement)(t,s)}),...Array.isArray(m)?m:[m]])});return s.displayName="".concat(e),s}},3639:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},2660:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},8501:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("CalendarDays",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]])},5302:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},8226:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},8736:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},2062:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Landmark",[["line",{x1:"3",x2:"21",y1:"22",y2:"22",key:"j8o0r"}],["line",{x1:"6",x2:"6",y1:"18",y2:"11",key:"10tf0k"}],["line",{x1:"10",x2:"10",y1:"18",y2:"11",key:"54lgf6"}],["line",{x1:"14",x2:"14",y1:"18",y2:"11",key:"380y"}],["line",{x1:"18",x2:"18",y1:"18",y2:"11",key:"1kevvc"}],["polygon",{points:"12 2 20 7 4 7",key:"jkujk7"}]])},5863:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},4794:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},2720:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]])},5805:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},7648:function(e,t,s){"use strict";s.d(t,{default:function(){return n.a}});var a=s(2972),n=s.n(a)},9376:function(e,t,s){"use strict";var a=s(5475);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},3508:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return P},dynamic:function(){return N}});var a=s(7437),n=s(2265),r=s(9376),i=s(7648),l=s(4603),c=s(5863),o=s(3639),u=s(2660),d=s(5302),m=s(4794),x=s(2720),h=s(8501),g=s(5805),y=s(2062),f=s(8226),p=s(9763);let k=(0,p.Z)("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),b=(0,p.Z)("CircleUserRound",[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var j=s(8736);let N="force-dynamic",v=e=>{let{message:t="Loading booking confirmation..."}=e;return(0,a.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-50",children:[(0,a.jsx)(c.Z,{className:"h-12 w-12 animate-spin text-blue-600 mb-4"}),(0,a.jsx)("span",{className:"text-lg text-gray-700",children:t})]})},w=e=>{let{title:t="Error",message:s,showBackButton:n=!0,backHref:r="/packages"}=e;return(0,a.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center text-center px-4 py-10 bg-gray-50",children:[(0,a.jsx)(o.Z,{className:"h-16 w-16 text-red-500 mb-6"}),(0,a.jsx)("h2",{className:"text-3xl font-semibold text-gray-800 mb-4",children:t}),(0,a.jsx)("p",{className:"text-gray-600 mb-8 max-w-md",children:s}),n&&(0,a.jsxs)(i.default,{href:r,className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors text-lg font-medium inline-flex items-center",children:[(0,a.jsx)(u.Z,{size:20,className:"mr-2"})," Back"]})]})};function Z(){let e=(0,r.useParams)(),{user:t,isAuthenticated:s,isLoading:c}=(0,l.a)(),o=e.bookingId,[p,N]=(0,n.useState)(null),[Z,P]=(0,n.useState)(!0),[S,_]=(0,n.useState)(null);if((0,n.useEffect)(()=>{if(!o){_("Booking ID is missing from the URL."),P(!1);return}(async()=>{P(!0),_(null);try{let e=await fetch("/api/bookings/".concat(o)),t=await e.json();if(!e.ok){let s=(null==t?void 0:t.message)||"Failed to fetch booking (Status: ".concat(e.status,")");throw Error(s)}N(t)}catch(e){_(e.message||"An unexpected error occurred while fetching booking details.")}P(!1)})()},[o]),Z||c)return(0,a.jsx)(v,{message:c?"Verifying session...":"Loading booking confirmation..."});if(S)return(0,a.jsx)(w,{title:"Booking Not Found",message:S,backHref:"/user/dashboard"});if(!p)return(0,a.jsx)(w,{title:"Booking Details Unavailable",message:"Could not retrieve booking details at this time.",backHref:"/user/dashboard"});let z=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return(0,a.jsx)("div",{className:"bg-gray-100 min-h-screen py-8 md:py-12 font-sans",children:(0,a.jsxs)("div",{className:"container mx-auto px-4 max-w-3xl",children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)(i.default,{href:"/user/dashboard",className:"text-blue-600 hover:text-blue-700 inline-flex items-center transition-colors group",children:[(0,a.jsx)(u.Z,{size:18,className:"mr-2 transition-transform group-hover:-translate-x-1"}),"Back to Dashboard"]})}),(0,a.jsx)("div",{className:"bg-white rounded-xl shadow-xl overflow-hidden",children:(0,a.jsxs)("div",{className:"p-6 md:p-8",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6 pb-4 border-b",children:[(0,a.jsxs)("h1",{className:"text-2xl md:text-3xl font-bold text-green-600 flex items-center mb-2 sm:mb-0",children:[(0,a.jsx)(d.Z,{size:30,className:"mr-3"})," Booking Confirmed!"]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Booking ID: ",(0,a.jsxs)("span",{className:"font-semibold text-gray-700",children:["#",p.booking_id]})]})]}),(0,a.jsxs)("section",{className:"mb-6",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold text-gray-800 mb-3 flex items-center",children:[(0,a.jsx)(m.Z,{size:22,className:"mr-2 text-blue-600"}),"Package Details"]}),(0,a.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[(0,a.jsx)("p",{className:"text-lg font-medium text-gray-700",children:p.package_name}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 flex items-center mt-1",children:[(0,a.jsx)(x.Z,{size:16,className:"mr-1.5 text-blue-500"})," ",p.package_category_name]})]})]}),(0,a.jsxs)("section",{className:"mb-6 grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-4 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(h.Z,{size:18,className:"mr-2.5 text-gray-500"}),(0,a.jsx)("span",{className:"font-medium text-gray-700",children:"Travel Dates:"}),(0,a.jsxs)("span",{className:"ml-1.5 text-gray-600",children:[z(p.start_date)," - ",z(p.end_date)]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(g.Z,{size:18,className:"mr-2.5 text-gray-500"}),(0,a.jsx)("span",{className:"font-medium text-gray-700",children:"Travelers:"}),(0,a.jsx)("span",{className:"ml-1.5 text-gray-600",children:p.total_people})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(y.Z,{size:18,className:"mr-2.5 text-gray-500"}),(0,a.jsx)("span",{className:"font-medium text-gray-700",children:"Total Amount:"}),(0,a.jsxs)("span",{className:"ml-1.5 text-gray-600 font-semibold",children:["₹",p.total_amount.toLocaleString("en-IN")]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(f.Z,{size:18,className:"mr-2.5 text-gray-500"}),(0,a.jsx)("span",{className:"font-medium text-gray-700",children:"Payment Status:"}),(0,a.jsx)("span",{className:"ml-1.5 text-gray-600 font-semibold ".concat("paid"===p.payment_status?"text-green-600":"text-orange-500"),children:p.payment_status})]}),(0,a.jsxs)("div",{className:"sm:col-span-2 flex items-center",children:[(0,a.jsx)(k,{size:18,className:"mr-2.5 text-gray-500"}),(0,a.jsx)("span",{className:"font-medium text-gray-700",children:"Booking Status:"}),(0,a.jsx)("span",{className:"ml-1.5 text-gray-600",children:p.booking_status})]})]}),(0,a.jsxs)("section",{className:"mb-6 pt-4 border-t",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold text-gray-800 mb-3 flex items-center",children:[(0,a.jsx)(b,{size:22,className:"mr-2 text-blue-600"}),"Guest Information"]}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{className:"font-medium text-gray-700 w-24 inline-block",children:"Name:"})," ",p.guest_name]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{className:"font-medium text-gray-700 w-24 inline-block",children:"Email:"})," ",p.guest_email]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{className:"font-medium text-gray-700 w-24 inline-block",children:"Phone:"})," ",p.guest_phone]})]})]}),p.special_requests&&(0,a.jsxs)("section",{className:"mb-8 pt-4 border-t",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold text-gray-800 mb-3 flex items-center",children:[(0,a.jsx)(j.Z,{size:20,className:"mr-2 text-blue-600"}),"Special Requests"]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded-md border whitespace-pre-line",children:p.special_requests})]}),"paid"!==p.payment_status&&(0,a.jsxs)("section",{className:"mt-8 pt-6 border-t text-center",children:[(0,a.jsx)("p",{className:"text-gray-700 mb-4",children:"Your booking is confirmed. To finalize your reservation, please proceed with the payment."}),(0,a.jsxs)("button",{onClick:()=>{alert("Pay Now clicked for booking ID: ".concat(o,". Payment integration is pending."))},className:"w-full sm:w-auto bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-10 rounded-lg text-lg transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50",children:["Pay Now (₹",p.total_amount.toLocaleString("en-IN"),")"]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-3",children:"You will be redirected to our secure payment gateway (simulation)."})]}),"paid"===p.payment_status&&(0,a.jsxs)("section",{className:"mt-8 pt-6 border-t text-center",children:[(0,a.jsxs)("p",{className:"text-green-600 font-semibold text-lg flex items-center justify-center",children:[(0,a.jsx)(d.Z,{size:24,className:"mr-2"})," Payment successfully completed for this booking."]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:"Thank you for choosing us! Your travel documents will be sent to you shortly."})]}),(0,a.jsxs)("div",{className:"mt-8 text-xs text-gray-500 text-center border-t pt-4",children:["Booked on: ",new Date(p.booking_created_at).toLocaleString("en-US",{dateStyle:"medium",timeStyle:"short"})]})]})})]})})}function P(){return(0,a.jsx)(n.Suspense,{fallback:(0,a.jsx)(v,{message:"Initializing page..."}),children:(0,a.jsx)(Z,{})})}},4603:function(e,t,s){"use strict";s.d(t,{H:function(){return l},a:function(){return c}});var a=s(7437),n=s(2265),r=s(9376);let i=(0,n.createContext)(void 0),l=e=>{let{children:t}=e,[s,l]=(0,n.useState)(null),[c,o]=(0,n.useState)(!0),u=(0,r.useRouter)(),d=(0,n.useCallback)(async()=>{try{console.log("Checking auth state via /api/auth/me...");let e=await fetch("/api/auth/me",{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include"}),t=await e.json();e.ok&&t.success&&t.data?(console.log("Auth check successful, user found:",t.data),l(t.data)):(console.log("Auth check failed or no user session found."),l(null))}catch(e){console.error("Error checking auth state:",e),l(null)}finally{o(!1)}},[]);(0,n.useEffect)(()=>{o(!0),d()},[d]);let m=(0,n.useCallback)(async(e,t)=>{o(!0);try{console.log("Attempting login with:",e);let s=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t}),credentials:"include"}),a=await s.json();if(s.ok&&a.success&&a.data)return console.log("Login successful:",a.data),l(a.data),o(!1),{success:!0,user:a.data};return console.error("Login API failed:",a.message),l(null),o(!1),{success:!1,user:null}}catch(e){return console.error("Login fetch error:",e),l(null),o(!1),{success:!1,user:null}}},[]),x=(0,n.useCallback)(async(e,t,s)=>{o(!0);try{console.log("Attempting registration for:",t);let a=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:t,password:s})}),n=await a.json();if(a.ok&&n.success)return console.log("Registration successful",n.message),o(!1),{success:!0,message:n.message||"Registration successful!"};return console.error("Registration API failed:",n.message),o(!1),{success:!1,message:n.message||"Registration failed."}}catch(e){return console.error("Registration fetch error:",e),o(!1),{success:!1,message:"An unexpected error occurred."}}},[]),h=(0,n.useCallback)(async()=>{try{console.log("Logging out..."),await fetch("/api/auth/logout",{method:"POST",credentials:"include"})}catch(e){console.error("Logout API call failed:",e)}finally{l(null),console.log("Redirecting to signin page after logout."),u.push("/auth/signin")}},[u]);return(0,a.jsx)(i.Provider,{value:{user:s,isAuthenticated:!!s,isLoading:c,login:m,register:x,logout:h,checkAuthState:d},children:t})},c=()=>{let e=(0,n.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},function(e){e.O(0,[2972,2971,2117,1744],function(){return e(e.s=4415)}),_N_E=e.O()}]);