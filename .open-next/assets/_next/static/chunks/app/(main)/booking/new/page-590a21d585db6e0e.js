(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9922],{6073:function(e,t,s){Promise.resolve().then(s.bind(s,1406))},1406:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return ea},dynamic:function(){return X}});var a=s(7437),r=s(2265),n=s(9376),o=s(7648),c=s(3145),l=s(4603),i=s(5863),d=s(3639),u=s(2660),m=s(3113),g=s(3245),h=s(4794),x=s(2720),p=s(5805),f=s(8226),b=s(9889),y=s(1994),j=s(3335);function v(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,j.m6)((0,y.W)(t))}let _=r.forwardRef((e,t)=>{let{className:s,type:r,...n}=e;return(0,a.jsx)("input",{type:r,className:v("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...n})});_.displayName="Input";var N=s(5293),w=s(535);let k=(0,w.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),S=r.forwardRef((e,t)=>{let{className:s,variant:r,size:n,asChild:o=!1,...c}=e,l=o?N.g7:"button";return(0,a.jsx)(l,{className:v(k({variant:r,size:n,className:s})),ref:t,...c})});S.displayName="Button";var R=s(1107);let F=(0,w.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),L=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(R.f,{ref:t,className:v(F(),s),...r})});L.displayName=R.f.displayName;let E=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("textarea",{className:v("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...r})});E.displayName="Textarea";var C=s(1047),I=s(2369),P=s(6842);let A="text-blue-600",D="text-red-700",O="border-gray-200",U="text-gray-800",q="text-gray-600",z="inline-flex items-center justify-center ".concat("bg-gray-800"," ").concat("hover:bg-gray-900"," ").concat("text-white"," font-semibold py-3 px-6 sm:px-8 rounded-full transition-all duration-300 shadow-md hover:shadow-lg transform hover:-translate-y-1 text-base sm:text-lg"),T="flex items-center mb-1.5 text-xs sm:text-sm font-medium ".concat(U),Z="w-full mt-1 px-3 py-2 text-sm sm:text-base rounded-md border ".concat(O," file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:").concat(q," focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-blue-500 disabled:opacity-70 disabled:cursor-not-allowed"),M="text-xs ".concat(D," mt-1"),B="p-3 sm:p-4 rounded-lg ".concat("bg-red-50"," border ").concat("border-red-200"," text-xs sm:text-sm ").concat(D),W="pt-4 sm:pt-5 border-t ".concat(O),J="text-base sm:text-md font-semibold ".concat(U," flex items-center"),G="flex flex-col gap-2 sm:flex-row sm:justify-between sm:items-center ".concat("bg-gray-100"," p-3 sm:p-4 rounded-lg border ").concat(O),H="text-sm sm:text-base font-semibold ".concat(U," flex items-center"),Y="text-lg sm:text-xl font-bold ".concat("text-green-800"," text-left sm:text-right"),$="text-xs ".concat(q," mt-1.5 sm:mt-2 text-left sm:text-right");function K(e){let{packageDetails:t,categoryDetails:s,user:o}=e,[c,l]=(0,r.useState)({total_people:1,start_date:"",end_date:"",guest_name:(null==o?void 0:o.name)||"",guest_email:(null==o?void 0:o.email)||"",guest_phone:(null==o?void 0:o.phone)||"",special_requests:""}),[d,u]=(0,r.useState)(s.price*c.total_people),[m,h]=(0,r.useState)({}),[x,f]=(0,r.useState)(!1);(0,n.useRouter)(),(0,r.useEffect)(()=>{u(s.price*Math.max(1,c.total_people))},[c.total_people,s.price]),(0,r.useEffect)(()=>{o&&l(e=>({...e,guest_name:e.guest_name||o.name||"",guest_email:e.guest_email||o.email||"",guest_phone:e.guest_phone||o.phone||""}))},[o]),(0,r.useEffect)(()=>{if(c.start_date&&t.number_of_days){let e=new Date(c.start_date),s=new Date(e);s.setDate(e.getDate()+t.number_of_days-1);let a=s.toISOString().split("T")[0];l(e=>({...e,end_date:a}))}},[c.start_date,t.number_of_days]);let b=e=>{let{name:t,value:s}=e.target,a=s;"total_people"===t&&(isNaN(a=parseInt(s,10))||a<1)&&(a=1),l(e=>({...e,[t]:a})),m[t]&&h(e=>({...e,[t]:void 0}))},y=()=>{let e={},t=new Date;return t.setHours(0,0,0,0),c.total_people<1&&(e.total_people="At least 1 traveler is required."),c.start_date?new Date(c.start_date)<t&&(e.start_date="Start date cannot be in the past."):e.start_date="Start date is required.",c.end_date||(e.end_date="End date could not be calculated. Please check the start date."),c.guest_name.trim()||(e.guest_name="Guest name is required."),c.guest_email.trim()?/\S+@\S+\.\S+/.test(c.guest_email)||(e.guest_email="Email address is invalid."):e.guest_email="Guest email is required.",c.guest_phone.trim()?/^\d{10,}$/.test(c.guest_phone.replace(/\s+/g,""))||(e.guest_phone="Phone number seems invalid."):e.guest_phone="Guest phone number is required.",h(e),0===Object.keys(e).length},j=async e=>{if(e.preventDefault(),h(e=>({...e,general:void 0})),!y())return;f(!0);let a={packageId:t.id.toString(),categoryId:s.id.toString(),userId:(null==o?void 0:o.id)||null,guestDetails:{name:c.guest_name,email:c.guest_email,mobileNumber:c.guest_phone},dates:{startDate:c.start_date,endDate:c.end_date},totalPeople:c.total_people};try{let e=await fetch("/api/bookings/initiate-payment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),t=await e.json();if(e.ok&&t.success&&t.redirectUrl){window.location.href=t.redirectUrl;return}h(s=>({...s,general:t.message||"Failed to initiate payment. (Status: ".concat(e.status,")")}))}catch(e){console.error("Error submitting booking form for payment:",e),h(e=>({...e,general:"An unexpected error occurred. Please try again."}))}finally{f(!1)}};return(0,a.jsxs)("form",{onSubmit:j,className:"space-y-4 sm:space-y-5",children:[m.general&&(0,a.jsx)("div",{className:B,children:m.general}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(L,{htmlFor:"total_people",className:T,children:[(0,a.jsx)(p.Z,{size:14,className:"mr-1.5 sm:mr-2 ".concat(A)})," Number of Travelers"]}),(0,a.jsx)(_,{type:"number",id:"total_people",name:"total_people",value:c.total_people,onChange:b,min:"1",className:Z,"aria-describedby":m.total_people?"total_people-error":void 0}),m.total_people&&(0,a.jsx)("p",{id:"total_people-error",className:M,children:m.total_people})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(L,{htmlFor:"start_date",className:T,children:[(0,a.jsx)(C.Z,{size:14,className:"mr-1.5 sm:mr-2 ".concat(A)})," Start Date"]}),(0,a.jsx)(_,{type:"date",id:"start_date",name:"start_date",value:c.start_date,onChange:b,className:Z,min:new Date().toISOString().split("T")[0],"aria-describedby":m.start_date?"start_date-error":void 0}),m.start_date&&(0,a.jsx)("p",{id:"start_date-error",className:M,children:m.start_date})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(L,{htmlFor:"end_date",className:T,children:[(0,a.jsx)(C.Z,{size:14,className:"mr-1.5 sm:mr-2 ".concat(A)})," End Date",t.number_of_days&&(0,a.jsxs)("span",{className:"ml-2 text-xs ".concat(q," font-normal"),children:["(Auto-calculated: ",t.number_of_days," days)"]})]}),(0,a.jsx)(_,{type:"date",id:"end_date",name:"end_date",value:c.end_date,readOnly:!0,className:"".concat(Z," bg-gray-50 cursor-not-allowed"),"aria-describedby":m.end_date?"end_date-error":void 0}),m.end_date&&(0,a.jsx)("p",{id:"end_date-error",className:M,children:m.end_date}),t.number_of_days&&!m.end_date&&(0,a.jsxs)("p",{className:"text-xs ".concat(q," mt-1"),children:["Automatically calculated based on ",t.number_of_days,"-day package duration"]})]})]}),(0,a.jsxs)("div",{className:"space-y-3 sm:space-y-4 ".concat(W),children:[(0,a.jsxs)("h3",{className:J,children:[(0,a.jsx)(I.Z,{size:16,className:"mr-2 sm:mr-2.5 ".concat(A)})," Guest Information"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(L,{htmlFor:"guest_name",className:T,children:"Full Name"}),(0,a.jsx)(_,{type:"text",id:"guest_name",name:"guest_name",value:c.guest_name,onChange:b,placeholder:"Enter full name",className:Z,"aria-describedby":m.guest_name?"guest_name-error":void 0}),m.guest_name&&(0,a.jsx)("p",{id:"guest_name-error",className:M,children:m.guest_name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(L,{htmlFor:"guest_email",className:T,children:"Email Address"}),(0,a.jsx)(_,{type:"email",id:"guest_email",name:"guest_email",value:c.guest_email,onChange:b,placeholder:"name@example.com",className:Z,"aria-describedby":m.guest_email?"guest_email-error":void 0}),m.guest_email&&(0,a.jsx)("p",{id:"guest_email-error",className:M,children:m.guest_email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(L,{htmlFor:"guest_phone",className:T,children:"Phone Number"}),(0,a.jsx)(_,{type:"tel",id:"guest_phone",name:"guest_phone",value:c.guest_phone,onChange:b,placeholder:"Enter 10-digit phone number",className:Z,"aria-describedby":m.guest_phone?"guest_phone-error":void 0}),m.guest_phone&&(0,a.jsx)("p",{id:"guest_phone-error",className:M,children:m.guest_phone})]})]}),(0,a.jsxs)("div",{className:W,children:[(0,a.jsxs)(L,{htmlFor:"special_requests",className:T,children:[(0,a.jsx)(g.Z,{size:14,className:"mr-1.5 sm:mr-2 ".concat(A)})," Special Requests (Optional)"]}),(0,a.jsx)(E,{id:"special_requests",name:"special_requests",value:c.special_requests,onChange:b,placeholder:"e.g., dietary needs, accessibility, preferred room view",rows:3,className:Z})]}),(0,a.jsxs)("div",{className:W,children:[(0,a.jsxs)("div",{className:G,children:[(0,a.jsxs)("p",{className:H,children:[(0,a.jsx)(P.Z,{size:16,className:"mr-1.5 sm:mr-2 ".concat("text-green-600")})," Total Amount"]}),(0,a.jsxs)("p",{className:Y,children:["₹",d.toLocaleString("en-IN")]})]}),(0,a.jsxs)("p",{className:$,children:["Based on ",c.total_people," traveler(s) at ₹",s.price.toLocaleString("en-IN")," per person."]})]}),(0,a.jsx)("div",{className:"pt-4 sm:pt-5",children:(0,a.jsx)(S,{type:"submit",className:"".concat(z," w-full h-auto text-sm sm:text-base py-2.5 sm:py-3 disabled:opacity-70 disabled:cursor-not-allowed disabled:hover:-translate-y-0 disabled:hover:shadow-md"),disabled:x,children:x?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.Z,{size:16,className:"animate-spin mr-2"})," Submitting..."]}):"Confirm & Proceed to Payment"})})]})}var V=s(5960);let X="force-dynamic",Q=e=>{let{message:t="Loading booking details..."}=e;return(0,a.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center ".concat(V.Cx," ").concat(V.dI),children:[(0,a.jsx)(i.Z,{className:"h-16 w-16 animate-spin ".concat(V.O9," mb-5")}),(0,a.jsx)("span",{className:"text-xl ".concat(V.Wx," font-semibold"),children:t}),(0,a.jsx)("p",{className:"".concat(V.tM," mt-1"),children:"Please wait a moment."})]})},ee=e=>{let{title:t="Error",message:s,showBackButton:r=!0}=e;return(0,a.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center text-center px-4 ".concat(V.dI," ").concat(V.AD," border ").concat(V.qB," rounded-2xl m-4 md:m-8"),children:[(0,a.jsx)(d.Z,{className:"h-20 w-20 ".concat(V.kq," mb-6")}),(0,a.jsx)("h2",{className:"text-3xl font-semibold ".concat(V.Mx," mb-4"),children:t}),(0,a.jsx)("p",{className:"".concat(V.tM," mb-8 max-w-md"),children:s}),r&&(0,a.jsxs)(o.default,{href:"/packages",className:"".concat(V.zi," bg-red-600 hover:bg-red-700 focus:ring-red-500"),children:[" ",(0,a.jsx)(u.Z,{size:20,className:"mr-2"})," Back to Packages"]})]})},et=e=>{let{images:t,altText:s,className:r="w-full h-48 object-cover rounded-lg"}=e;if(!t||0===t.length)return(0,a.jsxs)("div",{className:"".concat(r," bg-gray-200 flex items-center justify-center rounded-lg"),children:[(0,a.jsx)(m.Z,{size:32,className:"text-gray-400"}),(0,a.jsx)("span",{className:"ml-2 text-sm text-gray-500",children:"No image available"})]});let n=t[0];return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(c.default,{src:n,alt:s,width:400,height:300,className:"".concat(r," rounded-lg"),style:{objectFit:"cover"},onError:e=>{e.target.src="/images/placeholder.jpg"}}),t.length>1&&(0,a.jsxs)("div",{className:"absolute top-2 right-2 bg-black bg-opacity-50 text-white text-xs px-2 py-1 rounded",children:["+",t.length-1," more"]})]}),t.length>1&&(0,a.jsx)("div",{className:"flex gap-2 overflow-x-auto scrollbar-hide pb-1",children:t.slice(1,5).map((e,t)=>(0,a.jsx)(c.default,{src:e,alt:"".concat(s," ").concat(t+2),width:64,height:48,className:"w-16 h-12 object-cover rounded-md flex-shrink-0 border border-gray-200",style:{objectFit:"cover"},onError:e=>{e.target.src="/images/placeholder.jpg"}},t))})]})};function es(){let e=(0,n.useRouter)(),t=(0,n.useSearchParams)(),{user:s,isAuthenticated:c,isLoading:i}=(0,l.a)(),d=t.get("packageId"),y=t.get("categoryId"),[j,v]=(0,r.useState)(null),[_,N]=(0,r.useState)(null),[w,k]=(0,r.useState)(null),{data:S,error:R,status:F}=(0,b.i)(d?"/api/packages/".concat(d):null);return((0,r.useEffect)(()=>{if(!i){if(!d||!y){k("Package ID or Category ID is missing. Please select a package option again.");return}if("success"===F&&S){var e;v(S);let t=null===(e=S.categories)||void 0===e?void 0:e.find(e=>e.id.toString()===y);t?(N(t),k(null)):(k("The selected category (ID: ".concat(y,") was not found for this package. It might be unavailable.")),N(null))}else"error"===F&&(k((null==R?void 0:R.message)||"Failed to fetch package details for ID: ".concat(d,".")),v(null),N(null))}},[d,y,S,F,R,c,i,e]),i||"loading"===F||"idle"===F)?(0,a.jsx)(Q,{message:i?"Authenticating...":"Loading package details..."}):d&&y?w?(0,a.jsx)(ee,{message:w}):j&&_?(0,a.jsx)("div",{className:"".concat(V.Cx," min-h-screen py-4 sm:py-8 md:py-12 lg:py-16 font-sans"),children:(0,a.jsxs)("div",{className:"container mx-auto px-2 sm:px-4",children:[(0,a.jsx)("div",{className:"mb-4 sm:mb-6 md:mb-8",children:(0,a.jsxs)(o.default,{href:d?"/packages/".concat(d):"/packages",className:"".concat(V.zi," px-3 py-2 text-xs sm:px-4 sm:py-2 sm:text-sm bg-gray-50 hover:bg-gray-200 text-black-700 hover:text-black-900 border-gray-300 shadow-sm"),children:[(0,a.jsx)(u.Z,{size:16,className:"mr-1 sm:mr-2"})," Back to Package Details"]})}),(0,a.jsxs)("div",{className:"".concat(V.JB," p-3 sm:p-4 md:p-6 lg:p-10 shadow-xl"),children:[(0,a.jsxs)("h1",{className:"".concat(V.ME," text-xl sm:text-2xl md:text-3xl lg:text-4xl mb-4 sm:mb-6 md:mb-8 flex items-center justify-center md:justify-start"),children:[(0,a.jsx)(g.Z,{size:24,className:"mr-2 sm:mr-3 ".concat(V.O9," w-5 h-5 sm:w-6 sm:h-6")})," Confirm Your Booking"]}),(0,a.jsxs)("section",{className:"mb-4 sm:mb-6 md:mb-10 p-3 sm:p-4 md:p-6 rounded-xl ".concat(V.l8," border ").concat(V.x7," shadow-md"),children:[(0,a.jsxs)("h2",{className:"text-lg sm:text-xl font-semibold ".concat(V.Wx," mb-3 sm:mb-4 md:mb-6 flex items-center"),children:[(0,a.jsx)(h.Z,{size:20,className:"mr-2 sm:mr-3 ".concat(V.O9," w-4 h-4 sm:w-5 sm:h-5")})," Your Selection"]}),(0,a.jsx)("div",{className:"space-y-4 sm:space-y-6",children:(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-3 sm:gap-4 md:gap-6",children:[(0,a.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-base sm:text-lg font-medium ".concat(V.qf," mb-1 sm:mb-1.5"),children:j.name}),(0,a.jsx)("p",{className:"text-xs ".concat(V.tM," mb-1 sm:mb-1.5"),children:"Package"}),j.description&&(0,a.jsx)("p",{className:"text-xs ".concat(V.tM),style:{display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden"},children:j.description})]}),(0,a.jsxs)("div",{className:"".concat(V.JB," p-2 sm:p-3 md:p-4 bg-white"),children:[(0,a.jsxs)("h4",{className:"text-sm sm:text-base font-semibold ".concat(V.qf," flex items-center mb-1 sm:mb-1.5"),children:[(0,a.jsx)(x.Z,{size:16,className:"mr-1 sm:mr-2 ".concat(V.O9," w-3.5 h-3.5 sm:w-4 sm:h-4")})," ",_.category_name]}),(0,a.jsxs)("p",{className:"text-lg sm:text-xl font-bold ".concat(V.IW," mb-1 sm:mb-1.5"),children:[(0,a.jsx)("span",{className:"indian-rupee",children:"₹"}),_.price.toLocaleString("en-IN"),(0,a.jsx)("span",{className:"text-xs font-normal ".concat(V.tM),children:" / person"})]}),_.category_description&&(0,a.jsx)("p",{className:"text-xs ".concat(V.tM," mb-1 sm:mb-1.5"),children:_.category_description}),(0,a.jsxs)("p",{className:"text-xs ".concat(V.tM," flex items-center mb-1 sm:mb-1.5"),children:[(0,a.jsx)(p.Z,{size:12,className:"mr-1 sm:mr-1.5 ".concat(V.eB," w-3 h-3")}),"Covers up to ",_.max_pax_included_in_price," person(s) at this price."]}),_.hotel_details&&(0,a.jsxs)("p",{className:"text-xs ".concat(V.tM," border-t ").concat(V.J," pt-1 sm:pt-1.5"),children:["Hotel: ",_.hotel_details]})]})]}),(0,a.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"text-xs sm:text-sm font-medium ".concat(V.qf," mb-1 sm:mb-1.5 flex items-center"),children:[(0,a.jsx)(m.Z,{size:14,className:"mr-1 sm:mr-1.5 ".concat(V.O9," w-3 h-3 sm:w-3.5 sm:h-3.5")}),"Package Gallery"]}),(0,a.jsx)(et,{images:j.images_parsed,altText:j.name,className:"w-full h-32 sm:h-40 md:h-48 object-cover rounded-lg"})]}),_.images&&_.images.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"text-xs sm:text-sm font-medium ".concat(V.qf," mb-1 sm:mb-1.5 flex items-center"),children:[(0,a.jsx)(x.Z,{size:14,className:"mr-1 sm:mr-1.5 ".concat(V.O9," w-3 h-3 sm:w-3.5 sm:h-3.5")}),_.category_name," Images"]}),(0,a.jsx)(et,{images:_.images,altText:_.category_name,className:"w-full h-24 sm:h-28 md:h-32 object-cover rounded-lg"})]})]})]})})]}),(0,a.jsxs)("section",{className:"mb-4 sm:mb-6 md:mb-10",children:[(0,a.jsxs)("h2",{className:"".concat(V.ME," text-lg sm:text-xl md:text-2xl mb-3 sm:mb-4 md:mb-6 flex items-center"),children:[(0,a.jsx)(f.Z,{size:20,className:"mr-2 sm:mr-3 ".concat(V.eB," w-4 h-4 sm:w-5 sm:h-5")})," Guest & Payment Details"]}),(0,a.jsx)(K,{packageDetails:j,categoryDetails:_,user:s?{id:s.id.toString(),name:s.first_name||void 0,email:s.email||void 0,phone:void 0}:null})]}),(0,a.jsxs)("section",{className:"text-xs ".concat(V.tM," border-t ").concat(V.qc," pt-3 sm:pt-4 md:pt-6 mt-4 sm:mt-6 md:mt-8 text-center md:text-left"),children:[" ",c&&(null==s?void 0:s.email)?(0,a.jsxs)("p",{children:["Logged in as: ",(0,a.jsx)("span",{className:"font-medium ".concat(V.qf),children:s.email}),". Not you? ",(0,a.jsx)(o.default,{href:"/auth/signout",className:"".concat(V.Wx," hover:underline"),children:"Sign out"})]}):i||c?null:(0,a.jsxs)("p",{children:["Please ",(0,a.jsx)(o.default,{href:"/auth/signin?callbackUrl=".concat(encodeURIComponent(window.location.pathname+window.location.search)),className:"".concat(V.Wx," hover:underline font-medium"),children:"sign in"})," to complete your booking or continue as guest."]})]})]})]})}):(0,a.jsx)(ee,{message:"Could not load the selected package or category details. Please try again."}):(0,a.jsx)(ee,{message:w||"Package ID or Category ID is missing."})}function ea(){return(0,a.jsx)(r.Suspense,{fallback:(0,a.jsx)(Q,{message:"Loading page..."}),children:(0,a.jsx)(es,{})})}},4603:function(e,t,s){"use strict";s.d(t,{H:function(){return c},a:function(){return l}});var a=s(7437),r=s(2265),n=s(9376);let o=(0,r.createContext)(void 0),c=e=>{let{children:t}=e,[s,c]=(0,r.useState)(null),[l,i]=(0,r.useState)(!0),d=(0,n.useRouter)(),u=(0,r.useCallback)(async()=>{try{console.log("Checking auth state via /api/auth/me...");let e=await fetch("/api/auth/me",{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include"}),t=await e.json();e.ok&&t.success&&t.data?(console.log("Auth check successful, user found:",t.data),c(t.data)):(console.log("Auth check failed or no user session found."),c(null))}catch(e){console.error("Error checking auth state:",e),c(null)}finally{i(!1)}},[]);(0,r.useEffect)(()=>{i(!0),u()},[u]);let m=(0,r.useCallback)(async(e,t)=>{i(!0);try{console.log("Attempting login with:",e);let s=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t}),credentials:"include"}),a=await s.json();if(s.ok&&a.success&&a.data)return console.log("Login successful:",a.data),c(a.data),i(!1),{success:!0,user:a.data};return console.error("Login API failed:",a.message),c(null),i(!1),{success:!1,user:null}}catch(e){return console.error("Login fetch error:",e),c(null),i(!1),{success:!1,user:null}}},[]),g=(0,r.useCallback)(async(e,t,s)=>{i(!0);try{console.log("Attempting registration for:",t);let a=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:t,password:s})}),r=await a.json();if(a.ok&&r.success)return console.log("Registration successful",r.message),i(!1),{success:!0,message:r.message||"Registration successful!"};return console.error("Registration API failed:",r.message),i(!1),{success:!1,message:r.message||"Registration failed."}}catch(e){return console.error("Registration fetch error:",e),i(!1),{success:!1,message:"An unexpected error occurred."}}},[]),h=(0,r.useCallback)(async()=>{try{console.log("Logging out..."),await fetch("/api/auth/logout",{method:"POST",credentials:"include"})}catch(e){console.error("Logout API call failed:",e)}finally{c(null),console.log("Redirecting to signin page after logout."),d.push("/auth/signin")}},[d]);return(0,a.jsx)(o.Provider,{value:{user:s,isAuthenticated:!!s,isLoading:l,login:m,register:g,logout:h,checkAuthState:u},children:t})},l=()=>{let e=(0,r.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},9889:function(e,t,s){"use strict";s.d(t,{i:function(){return r}});var a=s(2265);function r(e,t){let s=(0,a.useRef)(!0);s.current&&(console.log("[useFetch] Hook initialized. URL:",e),s.current=!1);let[r,n]=(0,a.useState)({data:null,error:null,status:"idle"}),o=(0,a.useRef)(e),c=(0,a.useRef)(t);JSON.stringify(c.current)!==JSON.stringify(t)&&(c.current=t);let l=(0,a.useRef)(!0);return(0,a.useEffect)(()=>{if(console.log("[useFetch] useEffect entering. URL:",e,"Initial fetch:",l.current),o.current===e&&null!==e&&!l.current){console.log("[useFetch] useEffect skipped - URL unchanged and not first render");return}l.current=!1,o.current=e,console.log("[useFetch] useEffect triggered. URL:",e),(async()=>{if(console.log("[useFetch] fetchData started. URL:",e),!e){console.log("[useFetch] URL is null, setting state to idle/null."),n({data:null,error:null,status:"idle"});return}console.log("[useFetch] Resetting state and setting status to loading."),n({data:null,error:null,status:"loading"});try{let t;console.log("[useFetch] Attempting fetch to URL:",e);let s=e.startsWith("http")?e:"".concat(window.location.origin).concat(e);console.log("[useFetch] Full URL for fetch:",s);let a=await fetch(s,{...c.current,credentials:"include"});console.log("[useFetch] Fetch completed. URL:",e,"Status:",a.status);try{console.log("[useFetch] Attempting response.json(). URL:",e),t=await a.json(),console.log("[useFetch] response.json() successful. URL:",e)}catch(t){throw console.error("[useFetch] response.json() FAILED. URL:",e,"Error:",t),Error("Request failed with status ".concat(a.status," and non-JSON response."))}if(!a.ok){let s=(null==t?void 0:t.message)||a.statusText||"HTTP error! Status: ".concat(a.status);throw console.warn("[useFetch] Response not OK. Status:",a.status,"URL:",e,"Throwing error:",s),Error(s)}if(console.log("[useFetch] Response OK. Checking result.success. URL:",e),t.success)console.log("[useFetch] result.success is true. URL:",e),void 0!==t.data?(console.log("[useFetch] Setting state data and status=success. URL:",e),n({data:t.data,error:null,status:"success"})):(console.warn("[useFetch] Fetch successful (result.success=true) but result.data is undefined. Setting state data=null, status=success. URL: ".concat(e)),n({data:null,error:null,status:"success"}));else{let s=t.message||"API returned success: false";throw console.warn("[useFetch] result.success is false. URL:",e,"Throwing error:",s),Error(s)}}catch(s){console.error("[useFetch] CATCH block error for URL ".concat(e,":"),s);let t=s instanceof Error?s:Error("Unknown fetch error occurred");console.log("[useFetch] Setting state error and status=error. URL:",e),n({data:null,error:t,status:"error"})}})()},[e]),console.log("[useFetch] Returning state for URL:",e,{status:r.status}),{data:r.data,error:r.error,status:r.status,isLoading:"loading"===r.status}}},5960:function(e,t,s){"use strict";s.d(t,{$j:function(){return h},AD:function(){return v},Bc:function(){return i},Cx:function(){return k},ER:function(){return p},IW:function(){return u},J:function(){return S},JB:function(){return A},ME:function(){return P},MP:function(){return d},Mx:function(){return N},O9:function(){return l},UX:function(){return z},Wl:function(){return j},Wx:function(){return c},Yc:function(){return g},dI:function(){return I},dS:function(){return q},eB:function(){return m},ft:function(){return f},hc:function(){return y},kq:function(){return w},l8:function(){return n},m$:function(){return b},mT:function(){return T},nd:function(){return R},o5:function(){return a},oW:function(){return O},pb:function(){return U},qB:function(){return _},qc:function(){return F},qf:function(){return L},rW:function(){return Z},tA:function(){return M},tM:function(){return E},v4:function(){return x},x7:function(){return o},xb:function(){return C},zi:function(){return D}});let a="bg-gray-800",r="text-white",n="bg-blue-50",o="border-blue-100",c="text-blue-800",l="text-blue-600",i="bg-green-50",d="border-green-100",u="text-green-800",m="text-green-600",g="bg-orange-50",h="border-orange-100",x="text-orange-800",p="text-orange-600",f="bg-yellow-50",b="border-yellow-100",y="text-yellow-800",j="text-yellow-700",v="bg-red-50",_="border-red-200",N="text-red-700",w="text-red-500",k="bg-gray-50",S="border-gray-100",R="bg-gray-100",F="border-gray-200",L="text-gray-800",E="text-gray-600",C="text-gray-600",I="py-10 md:py-12",P="text-2xl font-bold ".concat(L," mb-6 flex items-center"),A="bg-white rounded-2xl shadow-sm border ".concat(S," p-6 transition-shadow hover:shadow-md"),D="inline-flex items-center justify-center ".concat(a," ").concat("hover:bg-gray-900"," ").concat(r," px-6 py-3 rounded-full font-medium transition-all duration-300 shadow-md"),O="inline-flex items-center justify-center ".concat("bg-white/20 backdrop-blur-sm"," ").concat("hover:bg-white/30"," ").concat("text-white"," ").concat("border border-white/40"," px-6 py-3 rounded-full font-medium transition-all duration-300");"".concat(n," rounded-2xl p-6 shadow-sm border ").concat(o),"".concat(g," rounded-2xl p-6 shadow-sm border ").concat(h),"".concat(i," rounded-2xl p-6 shadow-sm border ").concat(d),"".concat(f," rounded-2xl p-6 shadow-sm border ").concat(b);let U="bg-white p-2 rounded-full shadow-sm mr-3 border ".concat(S),q="flex items-center",z="hover:text-white",T="mx-1";"".concat(R," p-1 rounded-full inline-flex border ").concat(F),"".concat(a," ").concat(r," shadow-sm");let Z="relative h-[50vh] w-full rounded-2xl overflow-hidden shadow-lg mb-4 border ".concat(S),M="absolute bottom-0 left-0 right-0 p-6 bg-gradient-to-t from-black/70 to-transparent"}},function(e){e.O(0,[2972,5963,6815,2971,2117,1744],function(){return e(e.s=6073)}),_N_E=e.O()}]);