(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1438],{75627:function(e,s,t){Promise.resolve().then(t.bind(t,99915))},99915:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return u}});var r=t(57437),o=t(2265),n=t(29889),a=t(15863),l=t(61069),c=t(25721);function u(e){let{params:s}=e,[t,u]=(0,o.useState)((0,l.Z)(new Date,"yyyy-MM-dd")),[d,g]=(0,o.useState)((0,l.Z)((0,c.Z)(new Date,29),"yyyy-MM-dd")),{data:m,status:h,error:b,isLoading:f}=(0,n.i)("/api/vendor/inventory/calendar?serviceId=".concat(s.serviceId,"&from=").concat(t,"&to=").concat(d)),x=e=>{let s=new Date,t=(0,c.Z)(s,e);u((0,l.Z)(s,"yyyy-MM-dd")),g((0,l.Z)(t,"yyyy-MM-dd"))};return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"Availability Calendar"}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>x(6),className:"px-3 py-1 text-sm bg-blue-100 text-blue-700 rounded hover:bg-blue-200",children:"7 Days"}),(0,r.jsx)("button",{onClick:()=>x(29),className:"px-3 py-1 text-sm bg-blue-100 text-blue-700 rounded hover:bg-blue-200",children:"30 Days"}),(0,r.jsx)("button",{onClick:()=>x(89),className:"px-3 py-1 text-sm bg-blue-100 text-blue-700 rounded hover:bg-blue-200",children:"90 Days"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,r.jsx)("label",{htmlFor:"from-date",children:"From:"}),(0,r.jsx)("input",{id:"from-date",type:"date",value:t,onChange:e=>u(e.target.value),className:"border border-gray-300 rounded px-2 py-1"}),(0,r.jsx)("label",{htmlFor:"to-date",children:"To:"}),(0,r.jsx)("input",{id:"to-date",type:"date",value:d,onChange:e=>g(e.target.value),className:"border border-gray-300 rounded px-2 py-1"})]})]})]}),f&&(0,r.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,r.jsx)(a.Z,{className:"animate-spin mr-2"})," Loading availability data…"]}),"error"===h&&(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded p-4 text-red-700",children:[(0,r.jsx)("strong",{children:"Error:"})," ",null==b?void 0:b.message]}),"success"===h&&m&&(0,r.jsx)(i,{rows:m})]})}function i(e){let{rows:s}=e;if(0===s.length)return(0,r.jsx)("p",{children:"No data available for the selected date range."});let t=Array.from(new Set(s.map(e=>e.date))).sort(),o=Array.from(new Set(s.map(e=>e.room_type))),n=(e,s)=>{let t=e/s*100;return 0===t?"bg-red-100 text-red-800":t<25?"bg-orange-100 text-orange-800":t<50?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"},a=e=>{let s=new Date,t=new Date;return(t.setDate(s.getDate()+1),e===s.toISOString().split("T")[0])?"".concat(e," (Today)"):e===t.toISOString().split("T")[0]?"".concat(e," (Tomorrow)"):e};return(0,r.jsxs)("div",{className:"overflow-x-auto",children:[(0,r.jsxs)("table",{className:"min-w-full border text-sm",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"border p-3 text-left font-semibold",children:"Date"}),o.map(e=>(0,r.jsx)("th",{className:"border p-3 text-center font-semibold",children:e},e))]})}),(0,r.jsx)("tbody",{children:t.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"border p-3 whitespace-nowrap font-medium",children:a(e)}),o.map(t=>{let o=s.find(s=>s.date===e&&s.room_type===t);return(0,r.jsx)("td",{className:"border p-3 text-center",children:o?(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("span",{className:"inline-block px-2 py-1 rounded text-sm font-medium ".concat(n(o.available_rooms,o.total_rooms)),children:[o.available_rooms,"/",o.total_rooms]}),o.booked_rooms>0&&(0,r.jsxs)("div",{className:"text-xs text-gray-600",children:[o.booked_rooms," booked"]}),o.blocked_rooms>0&&(0,r.jsxs)("div",{className:"text-xs text-gray-600",children:[o.blocked_rooms," blocked"]}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:["₹",o.current_price]})]}):(0,r.jsx)("span",{className:"text-gray-400",children:"-"})},t)})]},e))})]}),(0,r.jsxs)("div",{className:"mt-4 flex flex-wrap gap-4 text-xs",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("div",{className:"w-3 h-3 bg-green-100 border border-green-200 rounded"}),(0,r.jsx)("span",{children:"High Availability (50%+)"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("div",{className:"w-3 h-3 bg-yellow-100 border border-yellow-200 rounded"}),(0,r.jsx)("span",{children:"Medium Availability (25-49%)"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("div",{className:"w-3 h-3 bg-orange-100 border border-orange-200 rounded"}),(0,r.jsx)("span",{children:"Low Availability (1-24%)"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("div",{className:"w-3 h-3 bg-red-100 border border-red-200 rounded"}),(0,r.jsx)("span",{children:"Fully Booked (0%)"})]})]})]})}},29889:function(e,s,t){"use strict";t.d(s,{i:function(){return o},q:function(){return n}});var r=t(2265);function o(e,s){let t=(0,r.useRef)(!0);t.current&&(console.log("[useFetch] Hook initialized. URL:",e),t.current=!1);let[o,n]=(0,r.useState)({data:null,error:null,status:"idle"}),a=(0,r.useRef)(e),l=(0,r.useRef)(s);JSON.stringify(l.current)!==JSON.stringify(s)&&(l.current=s);let c=(0,r.useRef)(!0);return(0,r.useEffect)(()=>{if(console.log("[useFetch] useEffect entering. URL:",e,"Initial fetch:",c.current),a.current===e&&null!==e&&!c.current){console.log("[useFetch] useEffect skipped - URL unchanged and not first render");return}c.current=!1,a.current=e,console.log("[useFetch] useEffect triggered. URL:",e),(async()=>{if(console.log("[useFetch] fetchData started. URL:",e),!e){console.log("[useFetch] URL is null, setting state to idle/null."),n({data:null,error:null,status:"idle"});return}console.log("[useFetch] Resetting state and setting status to loading."),n({data:null,error:null,status:"loading"});try{let s;console.log("[useFetch] Attempting fetch to URL:",e);let t=e.startsWith("http")?e:"".concat(window.location.origin).concat(e);console.log("[useFetch] Full URL for fetch:",t);let r=await fetch(t,{...l.current,credentials:"include"});console.log("[useFetch] Fetch completed. URL:",e,"Status:",r.status);try{console.log("[useFetch] Attempting response.json(). URL:",e),s=await r.json(),console.log("[useFetch] response.json() successful. URL:",e)}catch(s){throw console.error("[useFetch] response.json() FAILED. URL:",e,"Error:",s),Error("Request failed with status ".concat(r.status," and non-JSON response."))}if(!r.ok){let t=(null==s?void 0:s.message)||r.statusText||"HTTP error! Status: ".concat(r.status);throw console.warn("[useFetch] Response not OK. Status:",r.status,"URL:",e,"Throwing error:",t),Error(t)}if(console.log("[useFetch] Response OK. Checking result.success. URL:",e),s.success)console.log("[useFetch] result.success is true. URL:",e),void 0!==s.data?(console.log("[useFetch] Setting state data and status=success. URL:",e),n({data:s.data,error:null,status:"success"})):(console.warn("[useFetch] Fetch successful (result.success=true) but result.data is undefined. Setting state data=null, status=success. URL: ".concat(e)),n({data:null,error:null,status:"success"}));else{let t=s.message||"API returned success: false";throw console.warn("[useFetch] result.success is false. URL:",e,"Throwing error:",t),Error(t)}}catch(t){console.error("[useFetch] CATCH block error for URL ".concat(e,":"),t);let s=t instanceof Error?t:Error("Unknown fetch error occurred");console.log("[useFetch] Setting state error and status=error. URL:",e),n({data:null,error:s,status:"error"})}})()},[e]),console.log("[useFetch] Returning state for URL:",e,{status:o.status}),{data:o.data,error:o.error,status:o.status,isLoading:"loading"===o.status}}function n(e){let s=(0,r.useRef)(!0);s.current&&(console.log("[useSubmit] Hook initialized. Initial URL:",e),s.current=!1);let[t,o]=(0,r.useState)(null),[n,a]=(0,r.useState)(null),[l,c]=(0,r.useState)("idle");return{submit:async function(s){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"POST",r=arguments.length>2?arguments[2]:void 0,n=r||e;if(console.log("[useSubmit] submit function called. Target URL:",n,"Method:",t),c("loading"),o(null),a(null),!n)return console.error("[useSubmit] No URL provided (initial or override). Aborting submission."),a(Error("No URL specified for submission.")),c("error"),{success:!1,error:"No URL specified for submission."};try{let e;let r={method:t,headers:{"Content-Type":"application/json",Accept:"application/json"},body:"DELETE"!==t?JSON.stringify(s):void 0,credentials:"include"};console.log("[useSubmit] Attempting fetch. URL:",n);let a=await fetch(n,r);console.log("[useSubmit] Fetch completed. URL:",n,"Status:",a.status);try{console.log("[useSubmit] Attempting response.json(). URL:",n),204===a.status||"0"===a.headers.get("content-length")?(console.log("[useSubmit] Received 204 No Content or empty body. Assuming success."),e={success:!0}):e=await a.json(),console.log("[useSubmit] response.json() successful or handled empty. URL:",n)}catch(e){throw console.error("[useSubmit] response.json() FAILED. URL:",n,"Error:",e),Error("Request failed with status ".concat(a.status," and non-JSON response."))}if(console.log("[useSubmit] Checking response.ok and result.success. URL:",n),a.ok&&(void 0===e.success||!0===e.success)){if(console.log("[useSubmit] Response OK and result.success is true/undefined. URL:",n),void 0!==e.data)return console.log("[useSubmit] Setting data and status=success. URL:",n),o(e.data),c("success"),{success:!0,data:e.data};return o(null),c("success"),console.warn("[useSubmit] Submit successful (result.success=true/undefined) but result.data is undefined. Setting data=null, status=success. URL: ".concat(n)),{success:!0,data:null}}{let s=e.message||"API Error: Status ".concat(a.status,", Success Flag: ").concat(e.success);throw console.warn("[useSubmit] Response NOT OK or result.success is false. URL:",n,"Throwing error:",s),Error(s)}}catch(s){console.error("[useSubmit] CATCH block error. URL:",n,"Error:",s);let e=s instanceof Error?s.message:"Unknown submit error occurred";return console.log("[useSubmit] Setting error state and status=error. URL:",n),a(Error(e)),c("error"),{success:!1,error:e}}},data:t,error:n,status:l,isLoading:"loading"===l,reset:()=>{console.log("[useSubmit] reset function called."),o(null),a(null),c("idle")}}}}},function(e){e.O(0,[302,2971,2117,1744],function(){return e(e.s=75627)}),_N_E=e.O()}]);