(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9643],{9035:function(e,s,a){Promise.resolve().then(a.bind(a,287))},3639:function(e,s,a){"use strict";a.d(s,{Z:function(){return t}});let t=(0,a(9763).Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},7920:function(e,s,a){"use strict";a.d(s,{Z:function(){return t}});let t=(0,a(9763).Z)("BedDouble",[["path",{d:"M2 20v-8a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v8",key:"1k78r4"}],["path",{d:"M4 10V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4",key:"fb3tl2"}],["path",{d:"M12 4v6",key:"1dcgq2"}],["path",{d:"M2 18h20",key:"ajqnye"}]])},287:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return j},dynamic:function(){return p}});var t=a(7437),r=a(2265),i=a(9376),n=a(4603),l=a(9889),o=a(3340),d=a(5863),m=a(3639),c=a(7920),u=a(7648),x=a(3500),h=a(1079);let p="force-dynamic",g=[{label:"Wi-Fi",value:"wifi"},{label:"Air Conditioning",value:"ac"},{label:"Heating",value:"heating"},{label:"Television",value:"tv"},{label:"Mini Bar",value:"minibar"},{label:"Coffee/Tea Maker",value:"coffee_maker"},{label:"Hair Dryer",value:"hair_dryer"},{label:"Iron & Board",value:"iron"},{label:"Balcony/Patio",value:"balcony"},{label:"Ensuite Bathroom",value:"ensuite"},{label:"Work Desk",value:"desk"},{label:"Safe",value:"safe"}],f=e=>{let{text:s="Loading..."}=e;return(0,t.jsxs)("div",{className:"flex justify-center items-center py-10",children:[(0,t.jsx)(d.Z,{className:"h-6 w-6 animate-spin text-blue-600 mr-2"}),(0,t.jsx)("span",{children:s})]})},y=()=>(0,t.jsxs)("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 rounded-md shadow-md max-w-2xl mx-auto my-6",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(m.Z,{className:"h-5 w-5 mr-3"}),(0,t.jsx)("h3",{className:"font-semibold",children:"Verification Pending"})]}),(0,t.jsx)("p",{className:"mt-2 text-sm",children:"Your vendor profile is awaiting verification. You cannot manage services until verified."})]}),b=()=>(0,t.jsxs)("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-md shadow-md max-w-2xl mx-auto my-6",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(m.Z,{className:"h-5 w-5 mr-3"}),(0,t.jsx)("h3",{className:"font-semibold",children:"Incorrect Vendor Type"})]}),(0,t.jsx)("p",{className:"mt-2 text-sm",children:"This section is for Hotel vendors only."})]});function v(){let e=(0,i.useRouter)(),s=(0,i.useParams)(),a=s.serviceId,m=s.roomId,{user:p,isLoading:v,isAuthenticated:j}=(0,n.a)(),[N,_]=(0,r.useState)(null),[w,k]=(0,r.useState)(!1),S=(null==p?void 0:p.id)?"/api/vendors/profile?userId=".concat(p.id):null,{data:C,error:E,status:I}=(0,l.i)(S),q=(null==C?void 0:C.verified)===1,R=(null==C?void 0:C.type)==="hotel",F="success"===I&&C&&q&&R&&!!a,T=F?"/api/vendor/my-hotels/".concat(a):null,{data:A,error:P,status:M}=(0,l.i)(T),Z=(null==A?void 0:A.name)||"Hotel ".concat(a),B="success"===M&&!!A&&!!m,D=B?"/api/vendor/my-hotels/".concat(a,"/rooms/").concat(m):null,{data:O,error:H,status:J}=(0,l.i)(D),L=(e,s)=>{if(!e||"string"!=typeof e||!e.trim())return[];try{let a=JSON.parse(e);if(Array.isArray(a)&&a.every(e=>"string"==typeof e))return a;if(console.warn("Parsed ".concat(s," data is not an array of strings:"),a),"string"==typeof a&&a.trim())return[a.trim()];return[]}catch(a){if(console.error("Failed to parse ".concat(s," JSON:"),e,a),"string"==typeof e&&e.includes(","))return e.split(",").map(e=>e.trim()).filter(Boolean);if("string"==typeof e&&e.trim())return[e.trim()];return[]}};(0,r.useEffect)(()=>{if("success"===J&&O){var e;let s=L(O.amenities,"amenities"),a=L(O.images,"images");_({room_type_name:O.room_type_name,base_price:O.base_price.toString(),max_guests:O.max_guests.toString(),quantity_available:(null===(e=O.quantity_available)||void 0===e?void 0:e.toString())||"",amenities:s,images:a})}},[J,O]),(0,r.useEffect)(()=>{v||j&&(null==p?void 0:p.role_id)===3||e.replace("/auth/signin?reason=unauthorized_vendor")},[v,j,p,e]);let V=v||"loading"===I||F&&"loading"===M||B&&"loading"===J;if(V)return(0,t.jsx)(f,{text:"Loading Edit Room Form..."});if("error"===I||"success"===I&&!C)return(0,t.jsx)("div",{className:"text-red-600",children:"Error loading vendor profile or profile not found."});if(!q)return(0,t.jsx)(y,{});if(!R)return(0,t.jsx)(b,{});if("error"===M||"success"===M&&!A||"error"===J||"success"===J&&!O)return(0,t.jsxs)("div",{className:"text-red-600",children:[(null==P?void 0:P.message)||(null==H?void 0:H.message)||"Could not load hotel or room details.",(0,t.jsx)("br",{}),(0,t.jsx)(u.default,{href:"/my-hotels",className:"text-sm text-blue-600 hover:underline mt-2 inline-block",children:"Return to Hotel List"})]});if(!N)return(0,t.jsx)(f,{text:"Preparing form..."});let z=e=>{let{name:s,value:a}=e.target;_(e=>e?{...e,[s]:a}:null)},U=async s=>{if(s.preventDefault(),!N)return;if(k(!0),!N.room_type_name||!N.base_price||!N.max_guests||isNaN(parseFloat(N.base_price))||0>=parseFloat(N.base_price)||isNaN(parseInt(N.max_guests,10))||0>=parseInt(N.max_guests,10)){(0,o.Am)({variant:"destructive",title:"Validation Error",description:"Please fill Room Type Name, Base Price, and Max Guests with valid numbers."}),k(!1);return}let t={room_type_name:N.room_type_name,base_price:parseFloat(N.base_price),max_guests:parseInt(N.max_guests,10),quantity_available:N.quantity_available?parseInt(N.quantity_available,10):null,amenities:JSON.stringify(N.amenities),images:JSON.stringify(N.images)};try{let s=await fetch("/api/vendor/my-hotels/".concat(a,"/rooms/").concat(m),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),r=await s.json();if(!s.ok||!r.success)throw Error(r.message||"Failed to update room type");(0,o.Am)({title:"Success",description:"Room type updated successfully."}),e.push("/my-hotels/".concat(a,"/rooms"))}catch(e){console.error("Error updating room type:",e),(0,o.Am)({variant:"destructive",title:"Error",description:e instanceof Error?e.message:"Could not update room type."})}finally{k(!1)}};return(0,t.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg max-w-3xl mx-auto",children:[(0,t.jsx)("nav",{className:"mb-6 text-sm text-gray-500","aria-label":"Breadcrumb",children:(0,t.jsxs)("ol",{className:"list-none p-0 inline-flex space-x-2",children:[(0,t.jsx)("li",{className:"flex items-center",children:(0,t.jsx)(u.default,{href:"/dashboard",className:"hover:text-indigo-600 hover:underline",children:"Dashboard"})}),(0,t.jsx)("li",{children:(0,t.jsx)("span",{className:"text-gray-400",children:"/"})}),(0,t.jsx)("li",{className:"flex items-center",children:(0,t.jsx)(u.default,{href:"/my-hotels",className:"hover:text-indigo-600 hover:underline",children:"Hotels"})}),(0,t.jsx)("li",{children:(0,t.jsx)("span",{className:"text-gray-400",children:"/"})}),(0,t.jsx)("li",{className:"flex items-center",children:(0,t.jsx)(u.default,{href:"/my-hotels/".concat(a,"/edit"),className:"hover:text-indigo-600 hover:underline truncate max-w-[150px]",children:Z})}),(0,t.jsx)("li",{children:(0,t.jsx)("span",{className:"text-gray-400",children:"/"})}),(0,t.jsx)("li",{className:"flex items-center",children:(0,t.jsx)(u.default,{href:"/my-hotels/".concat(a,"/rooms"),className:"hover:text-indigo-600 hover:underline",children:"Rooms"})}),(0,t.jsx)("li",{children:(0,t.jsx)("span",{className:"text-gray-400",children:"/"})}),(0,t.jsxs)("li",{className:"flex items-center text-gray-700 font-medium truncate max-w-[150px]",children:["Edit: ",N.room_type_name]})]})}),(0,t.jsxs)("h2",{className:"text-2xl font-semibold text-gray-800 mb-6 flex items-center",children:[(0,t.jsx)(c.Z,{size:24,className:"mr-3 text-indigo-600"})," Edit Room Type: ",N.room_type_name]}),(0,t.jsxs)("form",{onSubmit:U,className:"space-y-6",children:[(0,t.jsxs)("fieldset",{className:"border border-gray-200 p-6 rounded-lg shadow-sm",children:[(0,t.jsx)("legend",{className:"text-lg font-semibold text-gray-700 px-2",children:"Room Details"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-4",children:[(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsxs)("label",{htmlFor:"room_type_name",className:"block text-sm font-medium text-gray-700 mb-1",children:["Room Type Name ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{type:"text",id:"room_type_name",name:"room_type_name",value:N.room_type_name,onChange:z,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"e.g., Deluxe Double, Standard Single"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"base_price",className:"block text-sm font-medium text-gray-700 mb-1",children:["Base Price/Night (INR) ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{type:"number",id:"base_price",name:"base_price",value:N.base_price,onChange:z,required:!0,min:"0",step:"0.01",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"e.g., 2500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"max_guests",className:"block text-sm font-medium text-gray-700 mb-1",children:["Max Guests ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{type:"number",id:"max_guests",name:"max_guests",value:N.max_guests,onChange:z,required:!0,min:"1",step:"1",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"e.g., 2"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"quantity_available",className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantity Available"}),(0,t.jsx)("input",{type:"number",id:"quantity_available",name:"quantity_available",value:N.quantity_available,onChange:z,min:"0",step:"1",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"e.g., 10"}),(0,t.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Number of rooms of this type."})]})]})]}),(0,t.jsxs)("fieldset",{className:"border border-gray-200 p-6 rounded-lg shadow-sm",children:[(0,t.jsx)("legend",{className:"text-lg font-semibold text-gray-700 px-2",children:"Amenities & Images"}),(0,t.jsxs)("div",{className:"space-y-6 mt-4",children:[(0,t.jsx)(x.c,{label:"Room Amenities",name:"amenities",options:g,selectedValues:N.amenities,onChange:(e,s)=>{_(a=>a?{...a,[e]:s}:null)},gridCols:3,helperText:"Select amenities available in this room type."}),(0,t.jsx)(h.w,{label:"Room Images",onImagesUploaded:e=>{N&&_({...N,images:e})},existingImages:N.images,parentId:a,type:"room",maxImages:6,helperText:"Upload photos specific to this room type (beds, bathroom, views)."})]})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-4 pt-4",children:[(0,t.jsx)(u.default,{href:"/my-hotels/".concat(a,"/rooms"),className:"bg-gray-200 text-gray-800 px-4 py-2 rounded-md text-sm font-medium hover:bg-gray-300 transition duration-150 ease-in-out",children:"Cancel"}),(0,t.jsx)("button",{type:"submit",disabled:!!(w||V),className:"inline-flex items-center bg-indigo-600 text-white px-6 py-2 rounded-md text-sm font-medium hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed transition duration-150 ease-in-out",children:w?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Z,{size:16,className:"animate-spin mr-2"})," Saving Changes..."]}):"Save Changes"})]})]})]})}function j(){return(0,t.jsx)(r.Suspense,{fallback:(0,t.jsx)(f,{text:"Loading Edit Room Page..."}),children:(0,t.jsx)(v,{})})}}},function(e){e.O(0,[2972,8503,2971,2117,1744],function(){return e(e.s=9035)}),_N_E=e.O()}]);